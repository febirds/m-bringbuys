(function(){this.JST||(this.JST={}),this.JST["admin/templates/undo"]=function(obj){var __p=[];with(obj||{})__p.push('<div class="edy-restore-notice edy-flash edy-header-flash edy-flash-with-x">\n  <div class="edy-flash-notice">\n    '),restored_model&&__p.push('<span class="edy-capital-letter">',I18n.t("undo.restored",{object_kind:I18n.t("undo.object_kind."+restored_model.get("kind"))}),"</span>"),__p.push("\n    "),collection_size>0?(__p.push('\n      <span class="edy-capital-letter">\n      '),restored_model?__p.push("\n        ",I18n.t("undo.deleted_before",{object_kind:I18n.t("undo.object_kind."+model.get("kind"))}),"\n      "):__p.push("\n        ",I18n.t("undo.deleted",{object_kind:I18n.t("undo.object_kind."+model.get("kind"))}),"\n      "),__p.push('\n      </span>\n      <a href="',model.get("restore_url"),'" data-remote="true" data-method="POST" data-behavior="restore-object">\n        '),restored_model?__p.push("\n          ",I18n.t("undo.undo_more"),"\n        "):__p.push("\n          ",I18n.t("undo.undo"),"\n        "),__p.push("\n      </a>\n    ")):__p.push("\n      ",I18n.t("undo.no_more_actions"),"\n    "),__p.push('\n    <div class="edy-flash-x" data-behavior="closes-flash"><?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <g id="close-big" fill="none" stroke-width="2" stroke="#000000">\n        <path class="shape" d="M1,1 L19,19 M1,19 L19,1"></path>\n    </g>\n</svg></div>\n  </div>\n</div>\n');return __p.join("")}}).call(this),function(){this.JST||(this.JST={}),this.JST["admin/templates/undo_error"]=function(obj){var __p=[];with(obj||{})__p.push('<div class="edy-restore-notice edy-flash edy-header-flash edy-flash-with-x">\n  <div class="edy-flash-alert">',message,'<div class="edy-flash-x" data-behavior="closes-flash"><?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <g id="close-big" fill="none" stroke-width="2" stroke="#000000">\n        <path class="shape" d="M1,1 L19,19 M1,19 L19,1"></path>\n    </g>\n</svg></div></div>\n</div>\n');return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["admin/templates/asset_thumb"]=function(obj){var __p=[];with(obj||{})__p.push('<div class="edy-thumb edy-asset '),isImage?__p.push("edy-asset-image"):__p.push("edy-asset-file"),__p.push('" data-cid="',cid,'">\n  <div class="edy-thumb-preview edy-asset-preview"></div>\n  <div class="edy-thumb-name edy-asset-name">',filename,"</div>\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["admin/templates/lightbox"]=function(obj){var __p=[];with(obj||{})__p.push('<div class="edy-modal-x" data-behavior="closes-modal"><?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <g id="close-big" fill="none" stroke-width="2" stroke="#000000">\n        <path class="shape" d="M1,1 L19,19 M1,19 L19,1"></path>\n    </g>\n</svg></div>\n<div class="edy-modal-lightbox-image"><img class="edy-lightbox-image" /></div>\n');return __p.join("")}}.call(this),function(e){var t=function(){var t=e(this);t.closest(".edy-select").find(".edy-select-text").html(t.find("option:selected").html()||"")};e.fn.extend({edySelect:function(){return this.each(function(){var i=e(this);i.data("edyselect")||(i.find(".edy-select-text").html(i.find("select option:selected").html()),i.data("edyselect",!0).on("edyselect:init","select",t))}),this}})}(Edicy.jQuery),function(e){e.fn.inlineStyles=function(){var e=this.attr("style"),t={};return e&&e.split(";").forEach(function(e){var i=e.split(":");2===i.length&&(t[i[0].trim()]=i[1].trim())}),t},e.fn.inlineStyle=function(e){var t=this.inlineStyles();return t[e]?t[e]:null}}(Edicy.jQuery),function(e){var t=function(e){this.$el=e,this.$input=this.$el.find(".edy-affixinput-input"),this.$text=this.$el.find(".edy-affixinput-text"),this.$placeholder=this.$el.find(".edy-affixinput-placeholder"),this.init()};t.prototype={init:function(){this.$el.on("click",e.proxy(this.handleClick,this)),this.$input.on({keydown:e.proxy(this.handleKeyup,this),keyup:e.proxy(this.handleKeyup,this),focus:e.proxy(this.handleFocus,this),blur:e.proxy(this.handleBlur,this)})},handleClick:function(){this.$placeholder.css("visibility","hidden"),this.$input.focus()},update:function(){""==this.$input.val()?this.$placeholder.html(this.$input.attr("placeholder")):this.$placeholder.html(this.$input.val()),this.$placeholder.show();var e=this.$placeholder.width();this.$placeholder.hide(),this.$text.css("margin-left",e+15)},handleKeyup:function(){setTimeout(e.proxy(this.update,this),0)},handleFocus:function(){},handleBlur:function(){}},e.fn.affixInput=function(){return this.each(function(){new t(e(this))})}}(Edicy.jQuery),function(e,t){Edicy.PopoverViewMixin={tagName:"div",className:"edy-reset edy-popover",events:{"ajax:before [data-ajax-id]":"handleAjaxBefore","ajax:complete [data-ajax-id]":"handleAjaxComplete",'click [data-behavior~="closes-popover"]':"handleCloseClick",click:"handleContainerClick","html:change":"handleContentsChanged",sideclose:"handleSideClose"},initialize:function(i){this.options=i,this.options.parent&&(this.options.parent=e(this.options.parent).get(0)),t.bindAll(this,"handleWindowResize","handleWindowScroll","handleAjaxLoadSuccess","showLoader","hideLoader"),t.defaults(this.options,{body:"",orientation:"bottom",changeOrientation:!0,sideClose:!0,relative:!1,propagateClicks:!0}),void 0!==this.popoverOptions&&t.extend(this.options,this.popoverOptions),this.initInputs(),this.globalEvents={resize:this.handleWindowResize,scroll:this.handleWindowScroll}},render:function(){this.$el.append(e("<div>",{"class":"edy-popover-content"}).html(this.options.body));var t=document.createElement("div");return t.classList.add("edy-popover-arrow"),"big"==this.options.arrow&&t.classList.add("edy-popover-arrow-big"),this.el.appendChild(t),this.options.sideClose&&this.$el.attr("data-sidecloses","true"),this.options.containerClass&&this.$el.addClass(this.options.containerClass),this.options.relative?this.$el.appendTo(this.options.parent):this.$el.appendTo(document.body),this.options.url&&this.loadFromUrl(),this.initInputs(),this},initInputs:function(){this.$("input, textarea").placeholder({customClass:"edy-placeholder"}),this.$(".edy-select").edySelect()},setBody:function(e){this.$(".edy-popover-content").html(e),this.setPosition(),this.initInputs()},setParent:function(e,i){this.options.parent=e,t.isUndefined(i)||(this.options.relative=i),this.setPosition(),this.options.relative?this.$el.appendTo(this.options.parent):this.$el.appendTo(document.body)},loadFromUrl:function(){return this.showLoader(),e.ajax({url:this.options.url,viewVariant:"popover",success:this.handleAjaxLoadSuccess})},handleAjaxBefore:function(t){var i=e(t.target);i.attr("data-ajax-id")&&e('[data-ajax-loader="'+i.attr("data-ajax-id")+'"]').dotLoader({replace:!0})},handleAjaxComplete:function(t){var i=e(t.target);i.attr("data-ajax-id")&&e('[data-ajax-loader="'+i.attr("data-ajax-id")+'"]').dotLoader(!1)},handleAjaxLoadSuccess:function(e){this.hideLoader(),this.setBody(e),this.trigger("edicy:popover:loaded")},handleContentsChanged:function(){this.initInputs()},handleCloseClick:function(e){e.preventDefault(),this.hide()},handleContainerClick:function(e){this.options.propagateClicks||e.stopPropagation()},handleWindowResize:function(){this.setPosition()},handleWindowScroll:function(){this.setPosition()},handleSideClose:function(e){this.options.parent&&!this.options.parent.contains(e.originalEvent.detail.source)&&this.hide()},setPosition:function(){var e,t=this.options.parent.getBoundingClientRect(),i=this.el.getBoundingClientRect(),s={top:window.pageYOffset,left:window.pageXOffset},n={top:t.top+s.top,left:t.left+s.left},a=this.options.relative?{top:0,left:0}:{top:t.top+s.top,left:t.left+s.left},o=i.width,l=i.height,d={top:0,left:0},r=this.options.orientation,c=5,h="big"==this.options.arrow?30:25,u={},p={width:window.innerWidth,height:window.innerHeight};a.width=t.width,a.height=t.height,this.changeOrientation&&"right"==r&&a.left+a.width+o>p.width&&(r="bottom"),this.changeOrientation&&"bottom"==r&&a.top+a.height+l>p.height+(this.options.relative?0:window.pageYOffset)&&(r="top"),"bottom"==r&&a.top+a.height+l>document.body.scrollHeight-50&&(r=a.top-l<0?a.left-o<0?"right":"left":"top"),("top"==r||"bottom"==r)&&(d.top="top"==r?a.top-c-l:a.top+a.height+c,d.left=a.left+Math.ceil(a.width/2)-Math.ceil(o/2),!this.options.relative&&d.left<0?(d.left=a.left,e="left"):!this.options.relative&&d.left+o>p.width?(d.left=a.left-o+h+Math.ceil(a.width/2),d.left+o>document.body.scrollWidth&&(d.left=document.body.scrollWidth-o),e="right"):this.options.relative&&n.left+d.left+o>p.width?(d.left=Math.max(-1*(n.left-5),Math.ceil(a.width/2)+h-o),u={left:Math.abs(d.left)+a.width/2},e="right"):this.options.relative&&n.left+d.left<=h?(d.left=Math.ceil(a.width/2)-h,u={left:parseInt(a.width/2,10)-d.left},e="left"):e="center"),("left"==r||"right"==r)&&("left"==r?(d.left=a.left-o,e="middle"):(d.left=a.left+a.width+c,e="middle"),d.top=a.top+Math.ceil(a.height/2)-Math.ceil(l/2),d.top<0&&(d.top=a.top,e="top")),this.$el.css(d),this.positionArrow(u),this.setArrow(e),this.setOrientation(r)},positionArrow:function(e){var t=this.el.querySelector(".edy-popover-arrow");t.style.top=e.top?e.top+"px":"",t.style.left=e.left?e.left+"px":""},setArrow:function(e){var t="edy-popover-arrow"+e;this.el.classList.contains(t)||(["top","right","bottom","left"].forEach(function(e){this.el.classList.remove("edy-popover-arrow"+e)}.bind(this)),this.el.classList.add(t))},setOrientation:function(e){["top","right","bottom","left"].forEach(function(e){this.el.classList.remove("edy-popover-"+e)}.bind(this)),this.el.classList.add("edy-popover-"+e)},showLoader:function(){0==this.$(".edy-popover-loader").length&&this.$el.prepend(e("<div>",{"class":"edy-popover-loader"})),this.$(".edy-popover-content").hide(),this.$(".edy-popover-loader").css({width:this.$el.outerWidth(!0),height:this.$el.outerHeight(!0)}).show(),this.$el.is(":visible")&&this.$(".edy-popover-loader").dotLoader()},hideLoader:function(){this.$(".edy-popover-loader").hide().dotLoader(!1),this.$(".edy-popover-content").show(),this.setPosition()},show:function(){this.el.style.display="block",this.setPosition(),this.$(".edy-popover-loader").is(":visible")&&this.$(".edy-popover-loader").dotLoader(),this.trigger("edicy:popover:opened"),setTimeout(e.proxy(function(){e(window).on(this.globalEvents)},this),0)},hide:function(){this.el.style.display="none",this.trigger("edicy:popover:closed"),e(window).off(this.globalEvents)},toggle:function(){this.isVisible()?this.hide():this.show()},isVisible:function(){return this.$el.is(":visible")}},Edicy.PopoverView=Edicy.Backbone.View.extend({}),Edicy.Backbone.mixin(Edicy.PopoverView,Edicy.PopoverViewMixin)}(Edicy.jQuery,Edicy.Underscore),function(e,t){Edicy.PanelViewMixin={tagName:"div",className:"edy-reset edy-modal-mask",events:{"ajax:before [data-ajax-id]":"handleAjaxBefore","ajax:complete [data-ajax-id]":"handleAjaxComplete",'click [data-behavior~="closes-modal"]':"handleCloseClick",'touchend [data-behavior~="closes-modal"]':"handleCloseClick",click:"handleMaskClick","html:change":"handleContentsChanged"},handleAjaxBefore:function(t){var i=e(t.target);i.attr("data-ajax-id")&&e('[data-ajax-loader="'+i.attr("data-ajax-id")+'"]').dotLoader({replace:!0})},handleAjaxComplete:function(t){var i=e(t.target);i.attr("data-ajax-id")&&e('[data-ajax-loader="'+i.attr("data-ajax-id")+'"]').dotLoader(!1)},initialize:function(e){this.options=e,t.bindAll(this,"handleDocumentKeyup"),t.defaults(this.options,{body:"",sideClose:!0,escapeCloses:!0,propagateClicks:!0}),void 0!==this.panelOptions&&t.extend(this.options,this.panelOptions),this.$(".edy-modal").length>0&&(this.$body=this.$(".edy-modal")),this.initInputs()},render:function(){return this.$el.hide().appendTo(document.body),this.$body=e("<div>",{"class":"edy-modal"}).html(this.options.body).appendTo(this.$el),this.options.containerClass&&this.$body.addClass(this.options.containerClass),this.initInputs(),this},initInputs:function(){this.$("input, textarea").placeholder({customClass:"edy-placeholder"}),this.$(".edy-select").edySelect()},handleContentsChanged:function(){this.initInputs()},handleCloseClick:function(e){e.preventDefault(),this.hide()},handleMaskClick:function(t){this.options.sideClose&&e(t.target).is(".edy-modal-mask")&&this.hide(),this.options.propagateClicks||t.stopPropagation()},handleDocumentKeyup:function(e){this.$el.trigger("edicy:modal:keyup",e),27==e.keyCode&&this.options.escapeCloses&&this.hide()},bindEvents:function(){e(window).on("keyup",this.handleDocumentKeyup)},unbindEvents:function(){e(window).off("keyup",this.handleDocumentKeyup)},setBody:function(e){this.$body.empty().html(e)},setVisible:function(e){e?(this.$el.is(":hidden")&&this.bindEvents(),this.$el.show()):(this.unbindEvents(),this.$el.hide())},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)}},Edicy.PanelView=Edicy.Backbone.View.extend({}),Edicy.Backbone.mixin(Edicy.PanelView,Edicy.PanelViewMixin)}(Edicy.jQuery,Edicy.Underscore),function(e,t){Edicy.SearchInputView=Edicy.Backbone.View.extend({events:{"keydown .edy-search-input":"handleSearchKeydown","input .edy-search-input":"handleSearchInput","click .edy-search-clear":"handleSearchClearClick"},initialize:function(e){this.options=t.defaults(e,{wait:500}),this.options.wait>0&&(this.handleSearchInput=t.debounce(this.handleSearchInput,500)),this.$(".edy-search-input").placeholder({customClass:"edy-placeholder"})},handleSearchKeydown:function(e){return 13===e.keyCode?!1:void 0},handleSearchInput:function(t){var i=e(t.target);i.closest("form").submit(),this.toggleSearchBtn()},handleSearchClearClick:function(){this.$(".edy-search-input").val("").trigger("input"),this.toggleSearchBtn()},toggleSearchBtn:function(){""!==this.$(".edy-search-input").val()?(this.$(".edy-search-btn").addClass("edy-hidden"),this.$(".edy-search-clear").removeClass("edy-hidden")):(this.$(".edy-search-clear").addClass("edy-hidden"),this.$(".edy-search-btn").removeClass("edy-hidden"))}})}(Edicy.jQuery,Edicy.Underscore),function(){Edicy.ImagePickerMixin={events:{'click [data-behavior~="show-image-picker"]':"handleSelectImageClick",'click [data-behavior~="remove-image"]':"handleRemoveImage","keydown .edy-search-input":"handleSearchKeydown","input .edy-search-input":"handleSearchInput"},initImagePicker:function(){this.imagePicker||(this.imagePicker=new Edicy.ImagePickerView({parent:this.$(".edy-page-image-select"),relative:!0,orientation:"top"}).render(),this.imagePicker.on("asset:selected",this.handleImageSelected,this))},handleSearchKeydown:function(e){return 13===e.keyCode?!1:void 0},handleSearchInput:function(e){var t=$(e.target),i=t.data("url");Edicy.jQuery.ajax({url:i,dataType:"script",viewVariant:"popover",data:{search:t.val()}})},handleSelectImageClick:function(e){e.preventDefault(),this.initImagePicker(),this.imagePicker.toggle(),this.imagePicker.loadImagesInView()},handleImageSelected:function(e){this.$(".edy-page-image").removeClass("edy-page-image-empty"),this.$("#page-image-id").val(e.id),this.$(".edy-page-image-preview").css("background-image","url("+Edicy.StringUtil.url_encode_quotes(e.thumbnail)+")")},handleRemoveImage:function(e){e.preventDefault(),e.stopPropagation(),this.$(".edy-page-image").addClass("edy-page-image-empty"),this.$("#page-image-id").val(""),this.$(".page-image-preview").css("background-image","none")}}}(),function(e){e.fn.loader=function(t,i){var s="spinner"==i?new Array(10).join("<div></div>"):new Array(4).join('<span class="dot"></span>'),n="spinner"==i?"edy-spinner":"dot-loader";return this.each(function(){var i=e(this);t===!1?(i.removeClass(n),i.data("edyLoaderContent")&&i.html(i.data("edyLoaderContent")).css("width","").removeData("edyLoaderContent").off("click.loader")):i.hasClass(n)||(t&&t.replace&&i.data("edyLoaderContent",i.html()).css("width",i.outerWidth()).on("click.loader",function(e){i.hasClass(n)&&(e.preventDefault(),e.stopPropagation())}),i.addClass(n).html(s))}),this},e.fn.dotLoader=function(t){return this.each(function(){e(this).loader(t,"dotloader")}),this},e.fn.spinner=function(t){return this.each(function(){e(this).loader(t,"spinner")}),this},Edicy.ui.dotLoader=function(t,i){e(t).dotLoader(i)}}(Edicy.jQuery),function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i}e.prototype=this.Event.prototype,this.CustomEvent=e}(this),function(){"classList"in document.documentElement||!Object.defineProperty||"undefined"==typeof HTMLElement||Object.defineProperty(HTMLElement.prototype,"classList",{get:function(){function e(e){return function(i){var s=t.className.split(/\s+/),n=s.indexOf(i);e(s,n,i),t.className=s.join(" ")}}var t=this,i={add:e(function(e,t,i){~t||e.push(i)}),remove:e(function(e,t){~t&&e.splice(t,1)}),toggle:e(function(e,t,i){~t?e.splice(t,1):e.push(i)}),contains:function(e){return!!~t.className.split(/\s+/).indexOf(e)},item:function(e){return t.className.split(/\s+/)[e]||null}};return Object.defineProperty(i,"length",{get:function(){return t.className.split(/\s+/).length}}),i}})}(this),function(){for(var e=0,t=["ms","moz","webkit","o"],i=0;i<t.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[t[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[i]+"CancelAnimationFrame"]||window[t[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var i=(new Date).getTime(),s=Math.max(0,16-(i-e)),n=window.setTimeout(function(){t(i+s)},s);return e=i+s,n}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),function(){var e=this,t=e.Dragdrop,i=function(){};e.Dragdrop=i,i.noConflict=function(){return e.dnd=t,this},i.utils={isFunction:function(e){return"function"==typeof e},isObject:function(e){return e===Object(e)},isFloating:function(t){var i=e.getComputedStyle(t);return/left|right/.test(i["float"])||/inline|table-cell/.test(i.display)},on:function(e,t,i,s){e.addEventListener(t,function(t){Array.prototype.slice.call(e.querySelectorAll(i)).forEach(function(e){e.contains(t.target)&&s(t)})})},matches:function(e,t){if(!e)return!1;var i=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector;return i?i.call(e,t):!1},closest:function(e,t){return e&&e!=document&&i.utils.matches(e,t)?e:e?i.utils.closest(e.parentNode,t):null},closestUntil:function(e,t,s){return e===t?t:i.utils.matches(e,s)?e:e?i.utils.closestUntil(e.parentNode,t,s):null},normalize:function(e){return"string"==typeof e?document.querySelectorAll(e):e instanceof Node?[e]:e instanceof NodeList?e:e instanceof Array?e:[]},overlappingPositions:function(e,t){return i.utils.rectOverlappingPositions(e.getBoundingClientRect(),t.getBoundingClientRect())},rectOverlappingPositions:function(e,t){return{top:e.top<t.top,right:e.left+e.width>t.left+t.width,bottom:e.top+e.height>t.top+t.height,left:e.left<t.left}},getOverlappingElement:function(e,t){for(var i,s,n=0,a=parseInt(e.style.left,10),o=parseInt(e.style.top,10),l=a+e.clientWidth,d=o+e.clientHeight,r=0,c=t.length;c>r;r++)if(s=t[r],s.parentNode){var h=s.getBoundingClientRect(),u=h.left+window.pageXOffset,p=h.top+window.pageYOffset,g=u+h.width,f=p+h.height,y=Math.max(0,Math.min(l,g)-Math.max(a,u)),m=Math.max(0,Math.min(d,f)-Math.max(o,p)),v=y*m;v>n&&(n=v,i=s)}return i},getClosestElement:function(e,t){for(var i=parseInt(e.style.left,10),s=parseInt(e.style.top,10),n=e.clientWidth,a=e.clientHeight,o=0,l=t.length;l>o;o++){var d=t[o],r=d.getBoundingClientRect(),c=r.left+window.pageXOffset,h=r.top+window.pageYOffset,u=r.width,p=r.height;if(!(c>i+n||i>c+u||h>s+a||s>h+p))return d}return null}}}(this),function(){var e=this.Dragdrop;e.currentDrags=[],e.Draggable=function(e,t){this.el=e,this.el.__draggable=this,this.options={distance:1,grid:1,gridOrigin:[0,0],tolerance:"closest",autoScroll:!0,propagate:!0};for(var i in t)"undefined"!=typeof t[i]&&(this.options[i]=t[i]);this.init()},e.Draggable.prototype={init:function(){this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseMove=this.handleMouseMove.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this),this.handleTouchMove=this.handleTouchMove.bind(this),this.handleTouchEnd=this.handleTouchEnd.bind(this),this.getDragHandles().forEach(function(e){e.addEventListener("touchmove",this.handleTouchMove),e.addEventListener("touchend",this.handleTouchEnd),e.addEventListener("touchcancel",this.handleTouchEnd),e.addEventListener("mousedown",this.handleMouseDown)}.bind(this))},destroy:function(){window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("mouseup",this.handleMouseUp),this.getDragHandles().forEach(function(e){e.removeEventListener("touchmove",this.handleTouchMove),e.removeEventListener("touchend",this.handleTouchEnd),e.removeEventListener("touchcancel",this.handleTouchEnd),e.removeEventListener("mousedown",this.handleMouseDown)}.bind(this)),this.el.__draggable=null},getDragHandles:function(){return this.options.handle?Array.prototype.slice.call(e.utils.normalize(this.el.querySelectorAll(this.options.handle))):[this.el]},handleMouseDown:function(e){1===e.which&&(e.preventDefault(),this.options.propagate||e.stopPropagation(),this.initialPosition={top:e.pageY,left:e.pageX},window.addEventListener("mousemove",this.handleMouseMove),window.addEventListener("mouseup",this.handleMouseUp))},handleDrag:function(e){this.dragging||(this.dragging=!0,this.dragStart(e)),this.dragging&&this.drag(e)},handleDragEnd:function(e){this.dragging&&(this.dragStop(e),this.dragging=!1,this.initialPosition=null)},handleMouseMove:function(e){e.stopPropagation(),this.dragging||this.isPastInitialDistance(e.pageY,e.pageX)&&(this.dragging=!0,this.dragStart(e)),this.dragging&&this.drag(e)},handleMouseUp:function(e){window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("mouseup",this.handleMouseUp),this.options.propagate||e.stopPropagation(),this.dragging&&(this.dragStop(e),this.dragging=!1,this.initialPosition=null)},handleTouchMove:function(e){if(e.targetTouches.length>0){var t=e.targetTouches[0];e.preventDefault(),this.initialPosition||(this.initialPosition={top:t.pageY,left:t.pageX}),this.dragging||this.isPastInitialDistance(t.pageY,t.pageX)&&(this.dragging=!0,this.dragStart(t)),this.dragging&&(this.lastTouch=t,this.drag(e))}},handleTouchEnd:function(){this.dragging&&(this.lastTouch&&(this.dragStop(this.lastTouch),this.lastTouch=null),this.dragging=!1,this.initialPosition=null)},isPastInitialDistance:function(e,t){return Math.max(Math.abs(t-this.initialPosition.left),Math.abs(e-this.initialPosition.top))>this.options.distance},getHelper:function(){return this.options.helper?this.options.helper(this.el):null},getDroppables:function(){return this.options.droppables?Array.prototype.slice.call(document.querySelectorAll(this.options.droppables)):[]},fillDroppableCache:function(){this.droppableCache=this.getDroppables()},releaseDroppableCache:function(){this.droppableCache=[]},getClosestElement:function(t){return"overlap"==this.options.tolerance?e.utils.getOverlappingElement(t,this.droppableCache):e.utils.getClosestElement(t,this.droppableCache)},isExcludedTarget:function(t){return this.options.exclude&&null!==e.utils.closest(t,this.options.exclude)},getEventDetails:function(){var e={helper:this.helper,draggable:this.el,payload:this.payload,pageX:this.position.pageX,pageY:this.position.pageY,clientX:this.position.clientX,clientY:this.position.clientY};return this.position&&this.lastposition&&(e.deltaX=this.lastposition.pageX-this.position.pageX,e.deltaY=this.lastposition.pageY-this.position.pageY),e},getEventCoordinates:function(e){var t={pageX:e.pageX,pageY:e.pageY};return"touchmove"==e.type&&e.touches.length>0?(t.clientX=e.touches[0].clientX,t.clientY=e.touches[0].clientY):(t.clientX=e.clientX,t.clientY=e.clientY),t},getPayload:function(){return e.utils.isFunction(this.options.payload)?this.options.payload(this.el):e.utils.isObject(this.options.payload)?this.options.payload:{}},calculateGridOffset:function(){var t;return t=e.utils.isFunction(this.options.gridOrigin)?this.options.gridOrigin():this.options.gridOrigin,[t[0]%parseInt(this.options.grid,10),t[1]%parseInt(this.options.grid,10)]},calculateHelperOffset:function(e,t,i){var s,n,a,o=this.el.getBoundingClientRect(),l=!e.parentNode;return a={top:parseInt(o.top+window.pageYOffset,10),left:parseInt(o.left+window.pageXOffset,10)},l&&document.body.appendChild(e),s=e.clientWidth,n=e.clientHeight,l&&document.body.removeChild(e),{top:i>a.top+n?Math.ceil(n/2):Math.abs(i-a.top),left:t>a.left+s?Math.ceil(s/2):Math.abs(t-a.left)}},calculatePositionWithGrid:function(e){var t=this.getEventCoordinates(e);return{pageX:this.roundToGrid(t.pageX,this.gridOffset[1]),pageY:this.roundToGrid(t.pageY,this.gridOffset[0]),clientX:this.roundToGrid(t.clientX,this.gridOffset[1]),clientY:this.roundToGrid(t.clientY,this.gridOffset[0])}},roundToGrid:function(e,t){return this.options.grid>1?Math.round(e/this.options.grid)*this.options.grid+t:e},dragStart:function(t){this.options.autoScroll&&(this.autoScrollBounds={width:document.body.scrollWidth,height:document.body.scrollHeight}),this.payload=this.getPayload(),this.lastposition=null,this.helper=this.getHelper(),this.helper&&(this.offsetDelta=this.calculateHelperOffset(this.helper,t.pageX,t.pageY),this.helper.style.position="absolute",this.helper.style.zIndex=9e4,this.helper.style.top=t.pageY-this.offsetDelta.top+"px",this.helper.style.left=t.pageX-this.offsetDelta.left+"px",this.helper.style.webkitTransform="translate3d(0,0,0)",this.helper.style.pointerEvents="none",document.body.appendChild(this.helper)),this.fillDroppableCache(),e.currentDrags.push(this),this.gridOffset=this.calculateGridOffset(),this.position=this.calculatePositionWithGrid(t),this.el.dispatchEvent(new CustomEvent("draggable:dragstart",{bubbles:!0,detail:this.getEventDetails()}))},drag:function(t){if(this.options.autoScroll&&this.edgeMove(t),this.position=this.calculatePositionWithGrid(t),this.lastposition){if(this.lastposition.pageY==this.position.pageY&&this.lastposition.pageX==this.position.pageX)return}else this.lastposition=this.position;if(this.helper&&(this.helper.style.top=this.position.pageY-this.offsetDelta.top+"px",this.helper.style.left=this.position.pageX-this.offsetDelta.left+"px"),this.el.dispatchEvent(new CustomEvent("draggable:drag",{bubbles:!0,detail:this.getEventDetails()})),this.droppableCache.length>0&&this.helper){var i=null,s=this.getEventCoordinates(t),n=document.elementFromPoint(s.clientX,s.clientY);if(this.isExcludedTarget(n)||(n=e.utils.closest(n,this.options.droppables),-1!=this.droppableCache.indexOf(n)?i=n:(i=this.getClosestElement(this.helper),i&&"pointer"==i.getAttribute("data-droppable-tolerance")&&(i=null))),!i)return this.lastTarget&&(this.lastTarget.dispatchEvent(new CustomEvent("draggable:dragleave",{bubbles:!0,detail:this.getEventDetails()})),this.lastTarget=null),this.lastposition=this.position,void 0;i!==this.lastTarget&&(this.lastTarget&&this.lastTarget.dispatchEvent(new CustomEvent("draggable:dragleave",{bubbles:!0,detail:this.getEventDetails()})),this.lastTarget=i,i.dispatchEvent(new CustomEvent("draggable:dragenter",{bubbles:!0,detail:this.getEventDetails()}))),i.dispatchEvent(new CustomEvent("draggable:dragover",{bubbles:!0,detail:this.getEventDetails()}))}this.lastposition=this.position},dragStop:function(){this.options.autoScroll&&this.stopAutoScroll(),this.releaseDroppableCache(),this.payload=this.getPayload(),this.lastTarget&&(this.lastTarget.dispatchEvent(new CustomEvent("draggable:drop",{bubbles:!0,detail:this.getEventDetails()})),this.lastTarget.dispatchEvent(new CustomEvent("draggable:dragleave",{bubbles:!0,detail:this.getEventDetails()})),this.lastTarget=null),this.helper&&this.helper.parentNode.removeChild(this.helper),this.helper=null,this.el.dispatchEvent(new CustomEvent("draggable:dragend",{bubbles:!0,detail:this.getEventDetails()})),e.currentDrags.splice(e.currentDrags.indexOf(this),1)},startAutoScroll:function(){this.autoScroll.scrolling=!0,this.autoScroll.currentScroll&&window.cancelAnimationFrame(this.autoScroll.currentScroll),this.autoScroll.prevTime=(new Date).getTime(),this.autoScroll.currentScroll=window.requestAnimationFrame(this.performAutoScroll.bind(this))},performAutoScroll:function(){var e=(new Date).getTime(),t=(e-this.autoScroll.prevTime)/1e3,i=this.autoScroll.speed*t;i>=1&&(window.scrollBy(this.autoScroll.x>0&&this.autoScrollBounds.width>window.pageXOffset+window.innerWidth||this.autoScroll.x<0&&window.pageXOffset>0?this.autoScroll.x*i:0,this.autoScroll.y>0&&this.autoScrollBounds.height>window.pageYOffset+window.innerHeight||this.autoScroll.y<0&&window.pageYOffset>0?this.autoScroll.y*i:0),this.autoScroll.prevTime=e,this.helper&&(this.helper.style.top=this.roundToGrid(this.autoScroll.clientY+window.pageYOffset-this.offsetDelta.top)+"px",this.helper.style.left=this.roundToGrid(this.autoScroll.clientX+window.pageXOffset-this.offsetDelta.left)+"px")),this.autoScroll.scrolling&&(window.cancelAnimationFrame(this.autoScroll.currentScroll),this.autoScroll.currentScroll=window.requestAnimationFrame(this.performAutoScroll.bind(this)))},stopAutoScroll:function(){this.autoScroll.scrolling=!1,this.autoScroll.currentScroll&&window.cancelAnimationFrame(this.autoScroll.currentScroll)},edgeMove:function(e){var t=60,i=this.getEventCoordinates(e),s=i.clientY<t,n=i.clientX>window.innerWidth-t,a=i.clientY>window.innerHeight-t,o=i.clientX<t;this.autoScroll={clientX:i.clientX,clientY:i.clientY,speed:500,x:n?1:o?-1:0,y:a?1:s?-1:0},0!==this.autoScroll.x||0!==this.autoScroll.y?this.startAutoScroll():this.stopAutoScroll()}},e.draggable=function(t,i){Array.prototype.slice.call(e.utils.normalize(t)).forEach(function(t){t.__draggable||new e.Draggable(t,i)})},e.draggables=function(t,i,s){Array.prototype.slice.call(e.utils.normalize(t)).forEach(function(t){t.addEventListener("mouseover",function(n){Array.prototype.slice.call(t.querySelectorAll(i)).forEach(function(t){t.contains(n.target)&&e.draggable(e.utils.closest(n.target,i),s)})}),t.addEventListener("touchstart",function(n){Array.prototype.slice.call(t.querySelectorAll(i)).forEach(function(t){t.contains(n.target)&&e.draggable([e.utils.closest(n.target,i)],s)})})})}}(this),function(){var e=this.Dragdrop;e.Sortable=function(e,t){this.el=e,this.el.__sortable=this,this.options=t,this.init()},e.Sortable.prototype={init:function(){e.draggables(this.el,this.options.items,{distance:this.options.distance,grid:this.options.grid,helper:this.options.helper,handle:this.options.handle,payload:this.options.payload,droppables:this.options.droppables,exclude:this.options.exclude,tolerance:this.options.tolerance}),e.utils.on(this.el,"draggable:dragstart",this.options.items,this.handleItemDragStart.bind(this)),e.utils.on(this.el,"draggable:dragend",this.options.items,this.handleItemDragEnd.bind(this)),this.el.addEventListener("draggable:dragenter",this.handleDragEnter.bind(this)),this.el.addEventListener("draggable:dragover",this.handleDragOver.bind(this)),this.el.addEventListener("draggable:drop",this.handleDrop.bind(this)),this.el.addEventListener("draggable:dragleave",this.handleDragLeave.bind(this))},getPlaceholder:function(t,i){if(t.__sortable_placeholder&&t.__current_sortable!=this.el&&delete t.__sortable_placeholder,!t.__sortable_placeholder){var s;e.utils.isFunction(this.options.placeholder)?s=this.options.placeholder(t,i):(s=document.createElement("div"),s.classList.add(this.options.placeholder)),t.__current_sortable=this.el,t.__sortable_placeholder=s}return t.__sortable_placeholder},acceptsDraggable:function(t){return e.utils.matches(t,this.options.accepts)},acceptsReceive:function(e,t){return this.options.acceptReceive?this.options.acceptReceive(e,t):!0},acceptsAppear:function(e,t){return this.options.acceptAppear?this.options.acceptAppear(e,t):!0},getSortables:function(){return this.options.items?this.getSortableContainer().querySelectorAll(this.options.items):[]},getSortableContainer:function(){return this.options.within?this.el.querySelector(this.options.within):this.el},handleDragEnter:function(e){this.acceptsDraggable(e.detail.draggable)&&(this.sortableCache=this.getSortables(),this.el.dispatchEvent(new CustomEvent("sortable:dragenter",{detail:{draggable:e.detail.draggable,payload:e.detail.payload}})))
},handleDragLeave:function(e){if(this.acceptsDraggable(e.detail.draggable)){var t=this.getPlaceholder(e.detail.draggable,e.detail.payload);t&&t.parentNode&&t.parentNode.removeChild(t),this.el.dispatchEvent(new CustomEvent("sortable:dragleave",{detail:{draggable:e.detail.draggable,payload:e.detail.payload}}))}},handleItemDragStart:function(e){e.detail.draggable.__sortable=this.el},handleDragOver:function(t){if(this.acceptsDraggable(t.detail.draggable)){t.stopPropagation();var i=t.detail.helper,s=this.getPlaceholder(t.detail.draggable,t.detail.payload),n=Array.prototype.slice.call(this.sortableCache),a=n.length;n.push(s);var o=e.utils.getOverlappingElement(i,n);if(o){var l=e.utils.overlappingPositions(i,o);e.utils.isFloating(o)?t.detail.deltaX<0?o.parentNode.insertBefore(s,o.nextSibling):t.detail.deltaX>0&&o.parentNode.insertBefore(s,o):l.bottom==l.top?t.detail.deltaY<0?o.parentNode.insertBefore(s,o.nextSibling):t.detail.deltaY>0&&o.parentNode.insertBefore(s,o):l.bottom?o.parentNode.insertBefore(s,o.nextSibling):o.parentNode.insertBefore(s,o)}else a>0&&this.getSortableContainer().appendChild(s);this.el.dispatchEvent(new CustomEvent("sortable:dragover",{detail:{receivedElement:o,draggable:t.detail.draggable,payload:t.detail.payload}}))}},handleItemDragEnd:function(e){e.stopPropagation(),delete e.detail.draggable.__sortable},handleDrop:function(t){this.acceptsDraggable(t.detail.draggable)&&(this.el.contains(t.detail.draggable)||e.utils.matches(t.detail.draggable,this.options.items)&&this.acceptsReceive(t.detail.draggable,t.detail.payload)?this.handleSort(t):this.acceptsAppear(t.detail.draggable,t.detail.payload)&&this.handleAppear(t))},handleSort:function(t){var i=this.getPlaceholder(t.detail.draggable,t.detail.payload),s=t.detail.draggable.__sortable,n=t.detail.draggable;(!i.parentNode||i.previousElementSibling!=t.detail.draggable&&i.nextElementSibling!=t.detail.draggable)&&(e.utils.isFunction(this.options.receive)&&s&&s!=this.el&&(n=this.options.receive(t.detail.draggable,t.detail.payload)),i.parentNode?(i.parentNode.insertBefore(n,i),i.parentNode.removeChild(i)):0===this.sortableCache.length&&this.getSortableContainer().appendChild(n),s&&s!=this.el&&(t.detail.draggable!=n&&t.detail.draggable.parentNode.removeChild(t.detail.draggable),s.dispatchEvent(new CustomEvent("sortable:remove",{detail:{draggable:t.detail.draggable,payload:t.detail.payload}})),this.el.dispatchEvent(new CustomEvent("sortable:receive",{detail:{receivedElement:n,draggable:t.detail.draggable,payload:t.detail.payload}}))),this.el.dispatchEvent(new CustomEvent("sortable:sort",{detail:{receivedElement:n,draggable:t.detail.draggable,payload:t.detail.payload}})))},handleAppear:function(e){var t,i=this.getPlaceholder(e.detail.draggable,e.detail.payload),s=this.options.appear(e.detail.draggable,e.detail.payload);Array.isArray(s)||(s=[s]);for(var n=0;n<s.length;n++)t=s[n],i.parentNode?i.parentNode.insertBefore(t,i):this.getSortableContainer().appendChild(t),this.el.dispatchEvent(new CustomEvent("sortable:appear",{detail:{appearedElement:t,draggable:e.detail.draggable,payload:e.detail.payload}})),e.detail.draggable.dispatchEvent(new CustomEvent("draggable:appear",{bubbles:!0,detail:{sortable:this.el}}));i.parentNode&&i.parentNode.removeChild(i)}},e.sortable=function(t,i){Array.prototype.slice.call(e.utils.normalize(t)).forEach(function(t){t.__sortable||new e.Sortable(t,i)})}}(this),function(){var e=this,t=this.Dragdrop;t.Resizable=function(e,t){this.el=e,this.el.__resizable=this,this.handleViewportResize=this.handleViewportResize.bind(this),this.options={handles:"e,s,se",aspectRatio:!1,propagatePointerEvents:!0,constraints:this.getConstraints.bind(this),validateDimensions:this.validateDimensions.bind(this),updateDimensions:this.updateDimensions.bind(this)};for(var i in t)this.options[i]=t[i];this.handlers=[]},t.Resizable.prototype={buildHandlers:function(){this.handlers.push(this.buildHandler("right","center","e")),this.handlers.push(this.buildHandler("right","bottom","se")),this.handlers.push(this.buildHandler("center","bottom","s")),this.handlers.push(this.buildHandler("left","bottom","sw")),this.handlers.push(this.buildHandler("left","center","w")),t.draggable(this.handlers,{autoScroll:!1,grid:this.options.grid,gridOrigin:this.getOffsetForResize.bind(this),propagate:this.options.propagatePointerEvents})},buildHandler:function(e,t,i){var s=document.createElement("div");return s._resizablePositionX=e,s._resizablePositionY=t,s._resizableCoordinate=i,s.classList.add(this.options.handler),s.style.webkitTransform="translate3d(0,0,0)",s.addEventListener("draggable:dragstart",this.handleDragStart.bind(this)),s.addEventListener("draggable:drag",this.handleDrag.bind(this)),s.addEventListener("draggable:dragend",this.handleDragEnd.bind(this)),s.addEventListener("click",this.handleHandlerClick.bind(this)),s},positionHandlers:function(){var e=this.el.getBoundingClientRect();this.handlers.forEach(function(t){"left"==t._resizablePositionX?t.style.left=e.left+window.pageXOffset+"px":"center"==t._resizablePositionX?t.style.left=e.left+e.width/2+window.pageXOffset+"px":"right"==t._resizablePositionX&&(t.style.left=e.left+e.width+window.pageXOffset+"px"),"center"==t._resizablePositionY?t.style.top=e.top+e.height/2+window.pageYOffset+"px":"bottom"==t._resizablePositionY&&(t.style.top=e.top+e.height+window.pageYOffset+"px")})},show:function(){0==this.handlers.length&&this.buildHandlers();var t=this.options.handles.split(",").map(function(e){return e.trim()});this.handlers.forEach(function(e){e.parentNode||-1===t.indexOf(e._resizableCoordinate)?e.parentNode&&-1===t.indexOf(e._resizableCoordinate)&&document.body.removeChild(e):document.body.appendChild(e)}),this.positionHandlers(),e.addEventListener("resize",this.handleViewportResize)},hide:function(){e.removeEventListener("resize",this.handleViewportResize),this.handlers.forEach(function(e){e.parentNode&&document.body.removeChild(e)})},setHandles:function(e){this.options.handles=e,this.show()},destroy:function(){this.hide(),this.el.__resizable=null},getConstraints:function(){return{}},validateDimensions:function(){return!0},updateDimensions:function(e){this.el.style.width=e.width+"px",this.el.style.height=e.height+"px"},performElementResize:function(e){this.options.validateDimensions(e)&&(this.options.updateDimensions(e),this.el.dispatchEvent(new CustomEvent("resizable:resize",{bubbles:!0})),this.positionHandlers())},getOffsetForResize:function(){var e=this.el.getBoundingClientRect();return[e.top+window.pageYOffset,e.left+window.pageXOffset]},handleDragStart:function(){this.el.dispatchEvent(new CustomEvent("resizable:resizestart",{bubbles:!0}));var e=this.el.getBoundingClientRect();this.initialSize={width:e.width,height:e.height},this.aspectRatio=e.height/e.width,this.constraints=this.options.constraints()},handleDrag:function(e){var t=this.el.getBoundingClientRect(),i=e.detail.draggable,s=parseInt(i.style.left,10)-e.detail.pageX,n=parseInt(i.style.top,10)-e.detail.pageY,a={initialWidth:this.initialSize.width,initialHeight:this.initialSize.height,previousWidth:t.width,previousHeight:t.height,width:t.width,height:t.height,handlerPosition:[i._resizablePositionX,i._resizablePositionY]};window.requestAnimationFrame(function(){"right"==i._resizablePositionX&&"center"==i._resizablePositionY&&(a.width=t.width-s),"left"==i._resizablePositionX&&"center"==i._resizablePositionY&&(a.width=t.width+s),this.constraints.maxWidth&&(a.width=Math.min(a.width,this.constraints.maxWidth)),"right"==i._resizablePositionX&&"bottom"==i._resizablePositionY&&(a.width=t.width-s,this.constraints.maxWidth&&(a.width=Math.min(a.width,this.constraints.maxWidth)),a.height=this.options.aspectRatio?a.width*this.aspectRatio:t.height-n),"left"==i._resizablePositionX&&"bottom"==i._resizablePositionY&&(a.width=t.width+s,this.constraints.maxWidth&&(a.width=Math.min(a.width,this.constraints.maxWidth)),a.height=this.options.aspectRatio?a.width*this.aspectRatio:t.height-n),"center"==i._resizablePositionX&&"bottom"==i._resizablePositionY&&(a.height=t.height-n),this.constraints.maxHeight&&(a.height=Math.min(a.height,this.constraints.maxHeight)),this.performElementResize(a)}.bind(this))},handleDragEnd:function(){this.el.dispatchEvent(new CustomEvent("resizable:resizeend",{bubbles:!0}))},handleHandlerClick:function(e){e.preventDefault(),this.options.propagatePointerEvents||e.stopPropagation()},handleViewportResize:function(){this.positionHandlers()}},t.resizable=function(e,i){Array.prototype.slice.call(t.utils.normalize(e)).forEach(function(e){e.__resizable||new t.Resizable(e,i)})}}(this),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(Edicy.jQuery)}(function(e){function t(t){var i={},s=/^jQuery\d+$/;return e.each(t.attributes,function(e,t){t.specified&&!s.test(t.name)&&(i[t.name]=t.value)}),i}function i(t,i){var s=this,a=e(s);if(s.value==a.attr("placeholder")&&a.hasClass(u.customClass))if(a.data("placeholder-password")){if(a=a.hide().nextAll('input[type="password"]:first').show().attr("id",a.removeAttr("id").data("placeholder-id")),t===!0)return a[0].value=i;a.focus()}else s.value="",a.removeClass(u.customClass),s==n()&&s.select()}function s(){var s,n=this,a=e(n),o=this.id;if(""===n.value){if("password"===n.type){if(!a.data("placeholder-textinput")){try{s=a.clone().attr({type:"text"})}catch(l){s=e("<input>").attr(e.extend(t(this),{type:"text"}))}s.removeAttr("name").data({"placeholder-password":a,"placeholder-id":o}).bind("focus.placeholder",i),a.data({"placeholder-textinput":s,"placeholder-id":o}).before(s)}a=a.removeAttr("id").hide().prevAll('input[type="text"]:first').attr("id",o).show()}a.addClass(u.customClass),a[0].value=a.attr("placeholder")}else a.removeClass(u.customClass)}function n(){try{return document.activeElement}catch(e){}}var a,o,l="[object OperaMini]"==Object.prototype.toString.call(window.operamini),d="placeholder"in document.createElement("input")&&!l,r="placeholder"in document.createElement("textarea")&&!l,c=e.valHooks,h=e.propHooks;if(d&&r)o=e.fn.placeholder=function(){return this},o.input=o.textarea=!0;else{var u={};o=e.fn.placeholder=function(t){var n={customClass:"placeholder"};u=e.extend({},n,t);var a=this;return a.filter((d?"textarea":":input")+"[placeholder]").not("."+u.customClass).bind({"focus.placeholder":i,"blur.placeholder":s}).data("placeholder-enabled",!0).trigger("blur.placeholder"),a},o.input=d,o.textarea=r,a={get:function(t){var i=e(t),s=i.data("placeholder-password");return s?s[0].value:i.data("placeholder-enabled")&&i.hasClass(u.customClass)?"":t.value},set:function(t,a){var o=e(t),l=o.data("placeholder-password");return l?l[0].value=a:o.data("placeholder-enabled")?(""===a?(t.value=a,t!=n()&&s.call(t)):o.hasClass(u.customClass)?i.call(t,!0,a)||(t.value=a):t.value=a,o):t.value=a}},d||(c.input=a,h.value=a),r||(c.textarea=a,h.value=a),e(function(){e(document).delegate("form","submit.placeholder",function(){var t=e("."+u.customClass,this).each(i);setTimeout(function(){t.each(s)},10)})}),e(window).bind("beforeunload.placeholder",function(){e("."+u.customClass).each(function(){this.value=""})})}}),function(){"use strict";Edicy.ProgressCircleView=function(e,t){this.options={progress:0,bgColor:"#ddd",fgColor:"#999",bgStroke:t.fgStroke||10,fgStroke:t.bgStroke||10};for(var i in t)"undefined"!=typeof t[i]&&(this.options[i]=t[i]);e.appendChild(this.render()),this.setProgress(this.options.progress)},Edicy.ProgressCircleView.prototype={render:function(){var e=this.options.width,t=this.options.height,i=Math.min(e,t),s=parseInt(i/2-this.options.bgStroke/2,10),n=i/2,a=i/2;return this.svg=this.make("svg",{"class":"progress-circle",width:i,height:i}),this.svg.appendChild(this.make("circle",{"class":"progress-circle-bg",fill:"none",cx:n,cy:a,r:s,stroke:this.options.bgColor,"stroke-width":this.options.bgStroke})),this.svg.appendChild(this.make("circle",{"class":"progress-circle-fg",fill:"none",cx:n,cy:a,r:s,stroke:this.options.fgColor,"stroke-width":this.options.fgStroke,transform:"rotate(-90 "+n+" "+a+")"})),this.svg},make:function(e,t){var i=document.createElementNS("http://www.w3.org/2000/svg",e);for(var s in t)i.setAttribute(s,t[s]);return i},calculateDashArray:function(e,t){var i=2*Math.PI*e,s=Math.max(0,Math.min(t,100))/100*i;return[s,i-s].join(",")},setProgress:function(e){var t=this.svg.querySelector(".progress-circle-fg"),i=parseInt(t.getAttribute("r"),10);isNaN(e)&&(e=0),0===e?t.setAttribute("opacity",0):(t.removeAttribute("opacity",""),t.setAttribute("stroke-dasharray",this.calculateDashArray(i,e)))},remove:function(){Edicy.dom.remove(this.svg)}},Edicy.progressCircle=function(e,t){return e.__edyProgressCircle||(e.__edyProgressCircle=new Edicy.ProgressCircleView(e,t)),e.__edyProgressCircle},Edicy.updateProgressCircle=function(e,t){e.__edyProgressCircle&&e.__edyProgressCircle.setProgress(t)},Edicy.removeProgressCircle=function(e){e.__edyProgressCircle&&(e.__edyProgressCircle.remove(),delete e.__edyProgressCircle)}}(),function(){"use strict";var e=function(e,t){var a,o,l,d,r,c="object"==typeof t&&t.maintainCase||!1,h="object"==typeof t&&t.titleCase?t.titleCase:!1,u="object"==typeof t&&"object"==typeof t.custom&&t.custom?t.custom:{},p="object"==typeof t&&t.separator||"-",g="object"==typeof t&&+t.truncate>1&&t.truncate||!1,f="object"==typeof t&&t.uric||!1,y="object"==typeof t&&t.uricNoSlash||!1,m="object"==typeof t&&t.mark||!1,v="object"==typeof t&&t.lang&&n[t.lang]?n[t.lang]:"object"!=typeof t||t.lang!==!1&&t.lang!==!0?n.en:{},b=[";","?",":","@","&","=","+","$",",","/"],w=[";","?",":","@","&","=","+","$",","],C=[".","!","~","*","'","(",")"],E="",S=p;if(h&&"number"==typeof h.length&&Array.prototype.toString.call(h)&&h.forEach(function(e){u[e+""]=e+""}),"string"!=typeof e)return"";for("string"==typeof t?p=t:"object"==typeof t&&(f&&(S+=b.join("")),y&&(S+=w.join("")),m&&(S+=C.join(""))),Object.keys(u).forEach(function(t){var s;s=t.length>1?new RegExp("\\b"+i(t)+"\\b","gi"):new RegExp(i(t),"gi"),e=e.replace(s,u[t])}),h&&(e=e.replace(/(\w)(\S*)/g,function(e,t,i){var s=t.toUpperCase()+(null!==i?i:"");return Object.keys(u).indexOf(s.toLowerCase())<0?s:s.toLowerCase()})),S=i(S),e=e.replace(/(^\s+|\s+$)/g,""),r=!1,o=0,d=e.length;d>o;o++)l=e[o],s[l]?(l=r&&s[l].match(/[A-Za-z0-9]/)?" "+s[l]:s[l],r=!1):!v[l]||f&&-1!==b.join("").indexOf(l)||y&&-1!==w.join("").indexOf(l)||m&&-1!==C.join("").indexOf(l)?(r&&(/[A-Za-z0-9]/.test(l)||E.substr(-1).match(/A-Za-z0-9]/))&&(l=" "+l),r=!1):(l=r||E.substr(-1).match(/[A-Za-z0-9]/)?p+v[l]:v[l],l+=void 0!==e[o+1]&&e[o+1].match(/[A-Za-z0-9]/)?p:"",r=!0),E+=l.replace(new RegExp("[^\\w\\s"+S+"_-]","g"),p);return E=E.replace(/\s+/g,p).replace(new RegExp("\\"+p+"+","g"),p).replace(new RegExp("(^\\"+p+"+|\\"+p+"+$)","g"),""),g&&E.length>g&&(a=E.charAt(g)===p,E=E.slice(0,g),a||(E=E.slice(0,E.lastIndexOf(p)))),c||h||h.length||(E=E.toLowerCase()),E},t=function(t){return function(i){return e(i,t)}},i=function(e){return e.replace(/[-\\^$*+?.()|[\]{}\/]/g,"\\$&")},s={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"Ae",Å:"A",Æ:"AE",Ç:"C",È:"E",É:"E",Ê:"E",Ë:"E",Ì:"I",Í:"I",Î:"I",Ï:"I",Ð:"D",Ñ:"N",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"Oe",Ő:"O",Ø:"O",Ù:"U",Ú:"U",Û:"U",Ü:"Ue",Ű:"U",Ý:"Y",Þ:"TH",ß:"ss",à:"a",á:"a",â:"a",ã:"a",ä:"ae",å:"a",æ:"ae",ç:"c",è:"e",é:"e",ê:"e",ë:"e",ì:"i",í:"i",î:"i",ï:"i",ð:"d",ñ:"n",ò:"o",ó:"o",ô:"o",õ:"o",ö:"oe",ő:"o",ø:"o",ù:"u",ú:"u",û:"u",ü:"ue",ű:"u",ý:"y",þ:"th",ÿ:"y",ẞ:"SS",α:"a",β:"b",γ:"g",δ:"d",ε:"e",ζ:"z",η:"h",θ:"8",ι:"i",κ:"k",λ:"l",μ:"m",ν:"n",ξ:"3",ο:"o",π:"p",ρ:"r",σ:"s",τ:"t",υ:"y",φ:"f",χ:"x",ψ:"ps",ω:"w",ά:"a",έ:"e",ί:"i",ό:"o",ύ:"y",ή:"h",ώ:"w",ς:"s",ϊ:"i",ΰ:"y",ϋ:"y",ΐ:"i",Α:"A",Β:"B",Γ:"G",Δ:"D",Ε:"E",Ζ:"Z",Η:"H",Θ:"8",Ι:"I",Κ:"K",Λ:"L",Μ:"M",Ν:"N",Ξ:"3",Ο:"O",Π:"P",Ρ:"R",Σ:"S",Τ:"T",Υ:"Y",Φ:"F",Χ:"X",Ψ:"PS",Ω:"W",Ά:"A",Έ:"E",Ί:"I",Ό:"O",Ύ:"Y",Ή:"H",Ώ:"W",Ϊ:"I",Ϋ:"Y",ş:"s",Ş:"S",ı:"i",İ:"I",ğ:"g",Ğ:"G",Ќ:"Kj",ќ:"kj",Љ:"Lj",љ:"lj",Њ:"Nj",њ:"nj",Тс:"Ts",тс:"ts",а:"a",б:"b",в:"v",г:"g",д:"d",е:"e",ё:"yo",ж:"zh",з:"z",и:"i",й:"j",к:"k",л:"l",м:"m",н:"n",о:"o",п:"p",р:"r",с:"s",т:"t",у:"u",ф:"f",х:"h",ц:"c",ч:"ch",ш:"sh",щ:"sh",ъ:"",ы:"y",ь:"",э:"e",ю:"yu",я:"ya",А:"A",Б:"B",В:"V",Г:"G",Д:"D",Е:"E",Ё:"Yo",Ж:"Zh",З:"Z",И:"I",Й:"J",К:"K",Л:"L",М:"M",Н:"N",О:"O",П:"P",Р:"R",С:"S",Т:"T",У:"U",Ф:"F",Х:"H",Ц:"C",Ч:"Ch",Ш:"Sh",Щ:"Sh",Ъ:"",Ы:"Y",Ь:"",Э:"E",Ю:"Yu",Я:"Ya",Є:"Ye",І:"I",Ї:"Yi",Ґ:"G",є:"ye",і:"i",ї:"yi",ґ:"g",č:"c",ď:"d",ě:"e",ň:"n",ř:"r",š:"s",ť:"t",ů:"u",ž:"z",Č:"C",Ď:"D",Ě:"E",Ň:"N",Ř:"R",Š:"S",Ť:"T",Ů:"U",Ž:"Z",ą:"a",ć:"c",ę:"e",ł:"l",ń:"n",ś:"s",ź:"z",ż:"z",Ą:"A",Ć:"C",Ę:"E",Ł:"L",Ń:"N",Ś:"S",Ź:"Z",Ż:"Z",ā:"a",ē:"e",ģ:"g",ī:"i",ķ:"k",ļ:"l",ņ:"n",ū:"u",Ā:"A",Ē:"E",Ģ:"G",Ī:"I",Ķ:"k",Ļ:"L",Ņ:"N",Ū:"U",ا:"a",أ:"a",إ:"i",آ:"aa",ؤ:"u",ئ:"e",ء:"a",ب:"b",ت:"t",ث:"th",ج:"j",ح:"h",خ:"kh",د:"d",ذ:"th",ر:"r",ز:"z",س:"s",ش:"sh",ص:"s",ض:"dh",ط:"t",ظ:"z",ع:"a",غ:"gh",ف:"f",ق:"q",ك:"k",ل:"l",م:"m",ن:"n",ه:"h",و:"w",ي:"y",ى:"a",ة:"h",ﻻ:"la",ﻷ:"laa",ﻹ:"lai",ﻵ:"laa","َ":"a","ً":"an","ِ":"e","ٍ":"en","ُ":"u","ٌ":"on","ْ":"","٠":"0","١":"1","٢":"2","٣":"3","٤":"4","٥":"5","٦":"6","٧":"7","٨":"8","٩":"9","“":'"',"”":'"',"‘":"'","’":"'","∂":"d",ƒ:"f","™":"(TM)","©":"(C)",œ:"oe",Œ:"OE","®":"(R)","†":"+","℠":"(SM)","…":"...","˚":"o",º:"o",ª:"a","•":"*",$:"USD","€":"EUR","₢":"BRN","₣":"FRF","£":"GBP","₤":"ITL","₦":"NGN","₧":"ESP","₩":"KRW","₪":"ILS","₫":"VND","₭":"LAK","₮":"MNT","₯":"GRD","₱":"ARS","₲":"PYG","₳":"ARA","₴":"UAH","₵":"GHS","¢":"cent","¥":"CNY","元":"CNY","円":"YEN","﷼":"IRR","₠":"EWE","฿":"THB","₨":"INR","₹":"INR","₰":"PF"},n={ar:{"∆":"delta","∞":"la-nihaya","♥":"hob","&":"wa","|":"aw","<":"aqal-men",">":"akbar-men","∑":"majmou","¤":"omla"},de:{"∆":"delta","∞":"unendlich","♥":"Liebe","&":"und","|":"oder","<":"kleiner als",">":"groesser als","∑":"Summe von","¤":"Waehrung"},en:{"∆":"delta","∞":"infinity","♥":"love","&":"and","|":"or","<":"less than",">":"greater than","∑":"sum","¤":"currency"},es:{"∆":"delta","∞":"infinito","♥":"amor","&":"y","|":"u","<":"menos que",">":"mas que","∑":"suma de los","¤":"moneda"},fr:{"∆":"delta","∞":"infiniment","♥":"Amour","&":"et","|":"ou","<":"moins que",">":"superieure a","∑":"somme des","¤":"monnaie"},pt:{"∆":"delta","∞":"infinito","♥":"amor","&":"e","|":"ou","<":"menor que",">":"maior que","∑":"soma","¤":"moeda"},ru:{"∆":"delta","∞":"beskonechno","♥":"lubov","&":"i","|":"ili","<":"menshe",">":"bolshe","∑":"summa","¤":"valjuta"}};if("undefined"!=typeof module&&module.exports)module.exports=e,module.exports.createSlug=t;else if("undefined"!=typeof define&&define.amd)define("speakingurl",[],function(){return e});else try{if(window.getSlug||window.createSlug)throw"speakingurl: globals exists /(getSlug|createSlug)/";window.getSlug=e,window.createSlug=t}catch(a){}}(),function(){var e,t;document.addEventListener("DOMContentLoaded",function(){document.addEventListener("dragenter",function(t){return e&&document.documentElement.contains(e)||document.body.dispatchEvent(new CustomEvent("dnd:dragenter",{bubbles:!0,detail:{originalEvent:t}})),t.stopPropagation(),t.preventDefault(),!1}),document.addEventListener("dragover",function(i){return clearTimeout(t),e||i.target.dispatchEvent(new CustomEvent("dnd:dragover",{bubbles:!0,detail:{originalEvent:i}})),i.preventDefault(),!1}),document.addEventListener("dragleave",function(i){return e&&document.documentElement.contains(e)||(t=setTimeout(function(){i.target.dispatchEvent(new CustomEvent("dnd:dragleave",{bubbles:!0,detail:{originalEvent:i}}))},50)),i.preventDefault(),!1}),document.addEventListener("drop",function(t){return t.stopPropagation(),t.preventDefault(),e&&document.documentElement.contains(e)||t.target.dispatchEvent(new CustomEvent("dnd:drop",{bubbles:!0,detail:{files:t.dataTransfer.files,originalEvent:t}})),!1}),window.addEventListener("dragstart",function(t){e=t.target}),window.addEventListener("dragend",function(){e=void 0}),window.addEventListener("dragstop",function(){e=void 0})})}(),function(){Edicy.dom={matches:function(e,t){if(!e)return!1;var i=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector;return i?i.call(e,t):!1},closest:function(e,t){return e&&("string"==typeof t&&Edicy.dom.matches(e,t)||e===t)?e:e?Edicy.dom.closest(e.parentNode,t):null},closestUntil:function(e,t,i){return e===t?t:e&&("string"==typeof i&&Edicy.dom.matches(e,i)||e===i)?e:e?Edicy.dom.closestUntil(e.parentNode,t,i):null},remove:function(e){e.parentNode&&e.parentNode.removeChild(e)},unwrap:function(e){if(e.parentNode){for(;e.firstChild;)e.parentNode.insertBefore(e.firstChild,e);e.parentNode.removeChild(e)}}},Edicy.event={on:function(e,t,i,s){e.addEventListener(t,function(e){var t=e.target;do if(Edicy.dom.matches(t,i))return e.delegateTarget=t,s.apply(this,arguments),void 0;while(t=t.parentNode)})}}}(),function(e,t){"use strict";var i=["application/bmp","application/jpg","application/png","application/preview","application/x-bmp","application/x-jpg","application/x-png","image/bmp","image/gif","image/jp_","image/jpeg","image/jpg","image/jpg","image/ms-bmp","image/pipeg","image/pjpeg","image/png","image/svg+xml","image/x-bitmap","image/x-bmp","image/x-ms-bmp","image/x-png","image/x-win-bitmap","image/x-windows-bmp","image/x-xbitmap","image/x-xbitmap"];Edicy.Asset=Edicy.Backbone.Model.extend({defaults:{status:"confirmed"},initialize:function(){this.uploadStatus={status:"queued",loaded:0,total:0,percentage:0,progress:0},this.progressCoefficient=(this.isImage()?Math.floor(11*Math.random()+70):97)/100,this.on({"upload:progress":this.handleUploadStatusChange,"upload:complete":this.handleUploadStatusChange,"upload:confirmed":this.handleUploadStatusChange,"upload:failed":this.handleUploadFailed},this)},toJSON:function(){return{asset:{filename:this.get("filename"),size:this.get("size"),content_type:this.get("content_type")}}},getExtension:function(){return this.get("filename").substring(this.get("filename").lastIndexOf(".")+1).toLowerCase()},isImage:function(){return t.contains(i,this.get("content_type"))},isConfirmed:function(){return"confirmed"==this.get("status")},uploadFile:function(i){return e.ajax({url:this.get("upload_url"),type:"put",data:i,processData:!1,xhr:t.bind(function(){var t=e.ajaxSettings.xhr();return t.upload&&(t.upload.onprogress=this.handleUploadProgress.bind(this)),t},this),beforeSend:t.bind(function(e){e.setRequestHeader("Content-Type",this.get("content_type")),e.setRequestHeader("x-amz-acl","public-read"),e.setRequestHeader("cache-control","max-age=3600")},this),success:this.handleUploadComplete.bind(this)})},handleUploadFailed:function(e,t){this.handleUploadStatusChange(e,t),e.collection.remove(e)},handleUploadProgress:function(e){if(e.lengthComputable){var t=100*e.loaded/e.total;this.trigger("upload:progress",this,{status:"uploading",loaded:e.loaded,total:e.total,percentage:t,progress:this.progressCoefficient*t})}},handleUploadComplete:function(){this.trigger("upload:complete",this,{status:"uploaded",loaded:this.get("size"),total:this.get("size"),percentage:100,progress:100*this.progressCoefficient})},showPseudoProgress:function(){this.updateProgressInterval=setInterval(t.bind(function(){this.trigger("upload:progress",this,{status:"uploading",loaded:this.uploadStatus.loaded,total:this.uploadStatus.total,percentage:100,progress:this.uploadStatus.progress+.5}),this.uploadStatus.progress>=98&&clearInterval(this.updateProgressInterval)},this),100)},handleUploadStatusChange:function(e,i){this.uploadStatus=t.extend(this.uploadStatus,i),("confirmed"==this.uploadStatus.status||"failed"==this.uploadStatus.status)&&clearInterval(this.updateProgressInterval)},loadImageDimensions:function(){var e=document.createElement("img");e.onload=function(){this.set({width:e.width,height:e.height})}.bind(this),e.src=this.get("thumbnail")},loadImage:function(e){if(this.isImage())if("undefined"!=typeof URL)setTimeout(function(){this.set("thumbnail",URL.createObjectURL(e)),this.loadImageDimensions()}.bind(this),10);else if("undefined"!=typeof FileReader){var t=new FileReader;t.onload=function(e){this.set("thumbnail",e.target.result),this.loadImageDimensions()}.bind(this),t.readAsDataURL(e)}}})}(Edicy.jQuery,Edicy.Underscore),function(){Edicy.ModelChangeMixin={hasChangedSinceLastSync:!1,initialize:function(){this.listenTo(this,"change",this.handleModelChanged),this.listenTo(this,"sync",this.handleModelSynced)},handleModelChanged:function(e,t){t&&t.fromSync||(this.hasChangedSinceLastSync=!0)},handleModelSynced:function(){this.hasChangedSinceLastSync=!1},hasPendingChanges:function(){return this.hasChangedSinceLastSync}}}(),function(e){Edicy.Form=Edicy.Backbone.Model.extend({initialize:function(){this.fields=new Edicy.Backbone.Collection([],{model:Edicy.FormField,comparator:function(e,t){return e.get("position")>t.get("position")?1:-1}}),this.fields.on({add:this.handleModelChanged,remove:this.handleModelChanged,change:this.handleModelChanged},this)},parse:function(t){return this.fields&&e.has(t,"fields")&&(this.fields.set(t.fields,{parse:!0}),delete t.fields),{submit_label:t.submit_label}},toJSON:function(){return{form:{submit_label:this.get("submit_label"),fields:this.fields.map(function(e){return e.toJSON()})}}}}),Edicy.Backbone.mixin(Edicy.Form,Edicy.ModelChangeMixin),Edicy.FormField=Edicy.Backbone.Model.extend({getOptionsStr:function(){return e.isArray(this.get("options"))?this.get("options").join("\n"):""},parse:function(t){return e.pick(t,"id","title","classname","format","options","placeholder","required","field_size","type","value","multiple","rows","paragraph")},toJSON:function(){var t=this.get("options");return e.isArray(t)&&e.all(t,e.isEmpty)&&(t=null),e.compactObject({id:this.id,title:this.get("title"),classname:this.get("classname"),format:this.get("format"),options:t,placeholder:this.get("placeholder"),required:this.get("required"),field_size:this.get("field_size"),type:this.get("type"),value:this.get("value"),multiple:this.get("multiple"),rows:this.get("rows"),paragraph:this.get("paragraph")})}})}(Edicy.Underscore),function(e){Edicy.Gallery=Edicy.Backbone.Model.extend({initialize:function(){this.assets||(this.assets=new Edicy.GalleryAssetsCollection),this.assets.on({add:this.handleModelChanged,change:this.handleModelChanged,remove:this.handleModelChanged},this)},setOption:function(t,i){var s=e.clone(this.get("settings"))||{};s[t]=i,this.set("settings",s)},getOption:function(e){return(this.get("settings")||{})[e]},parse:function(t){return e.has(t,"assets")&&(this.assets||(this.assets=new Edicy.GalleryAssetsCollection),this.assets.set(t.assets,{remove:!1})),{id:t.id,title:t.title,type:t.type,settings:t.settings}},toJSON:function(){var e={};return this.has("title")&&(e.title=this.get("title")),this.has("type")&&(e.kind=this.get("type")),this.assets&&(e.assets=this.assets.inject(function(e,t){return t.isConfirmed()&&e.push({id:t.id,title:t.get("title"),position:t.get("position")}),e},[])),this.has("settings")&&(e.settings=this.get("settings")),{media_set:e}}}),Edicy.Backbone.mixin(Edicy.Gallery,Edicy.ModelChangeMixin),Edicy.GalleryAssetsCollection=Edicy.Backbone.Collection.extend({model:Edicy.Asset,comparator:function(e,t){return e.get("position")>t.get("position")?1:-1},previousAsset:function(e){var t=this.indexOf(e)-1;return t>=0?this.at(t):void 0},nextAsset:function(e){return this.at(this.indexOf(e)+1)}})}(Edicy.Underscore),function(e){Edicy.Article=Edicy.Backbone.Model.extend({initialize:function(){this.set({data:new Edicy.Backbone.Model},{silent:!0}),this.listenTo(this.get("data"),"change",this.handleModelChanged)},parse:function(e){return this.url=e.url,this.get("data").set(this.get("data").attributes),e},setData:function(e,t){this.get("data").set(e,t)},toJSON:function(){var t=this.get("data").toJSON();return{article:e.compactObject({autosaved_title:this.get("autosaved_title"),autosaved_excerpt:this.get("autosaved_excerpt"),autosaved_body:this.get("autosaved_body"),tag_names:this.get("tag_names"),page_id:this.get("page_id"),data:e.isEmpty(t)?null:t})}}}),Edicy.Backbone.mixin(Edicy.Article,Edicy.ModelChangeMixin)}(Edicy.Underscore),function(){Edicy.Element=Edicy.Backbone.Model.extend({defaults:function(){return{values:{}}},getValue:function(e){return"title"==e?this.get("title"):this.get("values")[e]},setValue:function(e,t){"title"==e?this.set("title",t):this.get("values")[e]=t,this.handleModelChanged()},validate:function(e){return e.title?void 0:{title:I18n.t("errors.messages.empty")}},move:function(e){return Edicy.Backbone.sync("patch",this,{url:this.url()+"/move",data:JSON.stringify(e),contentType:"application/json"})},toJSON:function(){return{element:this.attributes}}}),Edicy.Backbone.mixin(Edicy.Element,Edicy.ModelChangeMixin)}(Edicy.Underscore),function(){Edicy.TextPartial=Edicy.Backbone.Model.extend({toJSON:function(){return{text_partial:{body:this.get("body")}}}}),Edicy.Backbone.mixin(Edicy.TextPartial,Edicy.ModelChangeMixin)}(Edicy.Underscore),function(){Edicy.ContentPartial=Edicy.Backbone.Model.extend({defaults:{metainfo:{}},setMetainfo:function(e,t){this.get("metainfo")||this.set("metainfo",{}),this.get("metainfo")[e]=t,this.handleModelChanged()},getMetainfo:function(e){return this.has("metainfo")?this.get("metainfo")[e]:void 0},toJSON:function(){return{content_partial:{body:this.get("body"),metainfo:this.get("metainfo")}}}}),Edicy.Backbone.mixin(Edicy.ContentPartial,Edicy.ModelChangeMixin)}(),function(e){Edicy.Language=Edicy.Backbone.Model.extend({toJSON:function(){return{language:{code:this.get("code"),title:this.get("title"),site_title:this.get("site_title"),site_header:this.get("site_header")}}},validate:function(t){return e.has(t,"errors")?t.errors:void 0}}),Edicy.Backbone.mixin(Edicy.Language,Edicy.ModelChangeMixin)}(Edicy.Underscore),function(){Edicy.Undo=Edicy.Backbone.Model.extend({})}(),function(e){Edicy.AssetsUploader=Edicy.Backbone.Collection.extend({model:Edicy.Asset,initialize:function(e){this.options=e,this.on("upload:confirmed",this.handleUploadConfirmed,this)},uploadFiles:function(e){return Array.prototype.slice.call(e).map(this.uploadFile.bind(this))},uploadFile:function(t){var i=this.add({filename:t.name,size:t.size,status:"new",content_type:""===t.type?"binary/octet-stream":t.type});return i.loadImage(t),i.save({},{error:function(e,t){e.collection.trigger("upload:confirmed"),e.trigger("upload:failed",e,{status:"failed",percentage:0,progress:100},t)}}).then(function(){return i.uploadFile(t)}).then(function(){return i.showPseudoProgress(),e.ajax({url:i.get("confirm_url"),method:"put",dataType:"script"})}).then(function(){i.set("status","confirmed"),i.trigger("upload:confirmed",i,{status:"confirmed",percentage:100,progress:100})}),i},getUploadProgress:function(){return this.reduce(function(e,t){return e+t.uploadStatus.progress},0)/this.size()},hasAllUploaded:function(){return this.all(function(e){return"confirmed"==e.get("status")})},handleUploadConfirmed:function(){this.hasAllUploaded()&&this.reset()}})}(Edicy.jQuery,Edicy.Underscore),function(e){var t="webkitAnimationEnd oAnimationEnd MSAnimationEnd animationend",i="webkitTransitionEnd oTransitionEnd MSTransitionEnd transitionend",s={scaleUpScaleUp:{outClass:"edyt-page-scaledownup",inClass:"edyt-page-scaleup edyt-page-delay300"},scaleDownFromLeft:{outClass:"edyt-page-scaledown",inClass:"edyt-page-movefromleft edyt-page-ontop"},moveLeftScaleUp:{outClass:"edyt-page-movetoleft edyt-page-ontop",inClass:"edyt-page-scaleup"},fadeOutFadeIn:{outClass:"edyt-page-fadeout",inClass:"edyt-page-fadein"}};Edicy.Animator=function(){var n=function(e,t){e.removeClass("edyt-page-current"),setTimeout(function(){e.attr("class",e.data("originalClassList")).addClass("edyt-page-hidden"),t.removeOutpage&&e.remove()},0)},a=function(e){e.attr("class",e.data("originalClassList")).addClass("edyt-page-current")};return{animate:function(i,s,n){var a=e(s);setTimeout(function(){a.addClass(i).one(t,function(){a.removeClass(i),n&&"function"==typeof n.end&&n.end.call()})},0)},transition:function(e,t){t.end&&(Edicy.Modernizr.csstransitions?e.one(i,t.end):t.end.call()),t.addClass&&setTimeout(function(){e.addClass(t.addClass)},0),t.removeClass&&setTimeout(function(){e.removeClass(t.removeClass)},0)},pageTransition:function(i,o,l,d){d=e.extend({removeOutpage:!0},d),l.removeClass("edyt-page-hidden"),o.removeClass("edyt-page-hidden"),l.closest(".edyt-pages-container").hasClass("edyt-pages-stacked")&&(o.addClass("edyt-page-absolute"),l.removeClass("edyt-page-absolute")),o.one(t,function(){n(o,d)}),l.one(t,function(){a(l,d)}),setTimeout(function(){o.data("originalClassList",o.attr("class")).addClass(s[i].outClass),l.data("originalClassList",l.attr("class")).addClass("edyt-page-current").addClass(s[i].inClass)},0),Edicy.Modernizr.cssanimations||(n(o,d),a(l,d))}}}()}(Edicy.jQuery),function(e){"use strict";Edicy.HelpPopoverView=Edicy.Backbone.View.extend({popoverOptions:{arrow:"big",orientation:"top",relative:!0,containerClass:"edy-help-popover"},events:{"ajax:beforeSend .contact-form ":"handleSubmitSupportQuestion","ajax:success .contact-form":"handleMessageSent","click .contact-form .textinput":"handleTextinputClick","submit .edy-search-form form":"handleSearchFormSubmit","click .edy-search-clear":"resetSearch"},initialize:function(){this.searchResultsPage=0,this.loading=!1,this.currentLang=I18n.locale||"en",this.on("edicy:popover:loaded",this.handleContentLoaded,this)
},handleContentLoaded:function(){this.searchInput=new Edicy.SearchInputView({el:this.$(".edy-search-form")}),this.fixContainerHeight()},fixContainerHeight:function(){var e=50;this.$(".edy-popover-content").css({height:this.$(".edy-popover-content").height()+e})},handleSubmitSupportQuestion:function(t){var i=e(t.target).find(".edy-btn"),s=i.closest(".contact-form").find("textarea");return s.val()?(i.dotLoader({replace:!0}),void 0):(t.preventDefault(),s.focus(),!1)},handleSearchFormSubmit:function(t){e(t.target).find(".textinput").val()?(this.clearSearchResults(),this.showResults(),this.hideContents()):this.resetSearch()},resetSearch:function(){this.hideResults(),this.showContents(),this.$(".edy-search-input").val(""),this.searchInput.toggleSearchBtn()},showResults:function(){this.$(".help-popover-search-results").show()},hideResults:function(){this.$(".help-popover-search-results").hide()},showContents:function(){this.$(".help-popover-contents").show()},hideContents:function(){this.$(".help-popover-contents").hide()},clearSearchResults:function(){this.$(".help-popover-search-results .results-inner").empty()},handleMessageSent:function(){var t=this.$(".edy-btn");Edicy.Animator.animate("edyt-page-fadeout",t,{end:function(){e(".help-popover .btn-container").addClass("success"),e(".help-popover .edy-btn").hide(),e(".help-popover .notice").show()}})},handleTextinputClick:function(){var e=this.$(".edy-btn"),t=e.parent();t.hasClass("success")&&this.resetSupportForm()},resetSupportForm:function(){var e=this.$(".edy-btn"),t=e.parent();t.removeClass("success"),t.find(".notice").remove(),e.fadeIn(800)}}),Edicy.Backbone.mixin(Edicy.HelpPopoverView,Edicy.PopoverViewMixin)}(Edicy.jQuery,Edicy.Underscore),function(e,t){Edicy.AdminToolbarView=Edicy.Backbone.View.extend({events:{"click .edy-mm-link-content":"handleContentLinkClick","click .edy-mm-link-settings":"handleSettingsLinkClick","click .edy-mm-link-account":"handleAccountLinkClick","click .edy-mm-link-files":"handleFilesClick","ajax:complete .edy-mm-link-files":"handleFilesLoadComplete","click .edy-mm-link-articles":"handleArticlesClick","ajax:complete .edy-mm-link-articles":"handleArticlesLoadComplete","click .edy-mm-link-reports":"handleReportsLinkClick","click .edy-mm-link-help":"handleHelpLinkClick","click .edy-bar-tools-save":"handleSaveClick",'click [data-behavior="toggle-toolbar-details"]':"handleToggleDetailsClick","click .edy-bar-reveal-rightside .edy-bar-leftside":"handleToggleDetailsClick","draggable:dragstart .edy-content-thumb":"handleThumbDragstart","draggable:dragend .edy-content-thumb":"handleThumbDragend","draggable:appear .edy-content-thumb":"handleThumbAppeared"},initialize:function(){t.bindAll(this,"handleKeyupEvent","handleKeydownEvent"),e(document.body).addClass("edy-bar-closed"),this.$el.removeClass("edy-bar-hidden"),Edicy.assets&&Edicy.assets.on({"upload:progress":this.handleUploadProgress,"upload:confirmed":this.handleUploadConfirmed},this),e(document).on({keydown:this.handleKeydownEvent,keyup:this.handleKeyupEvent}),Edicy.dragdrop.draggables(this.el,".edy-content-thumb",{handle:".edy-thumb-preview",helper:this.getDragProxy,payload:this.getDragPayload,droppables:".edy-ca-sortable",exclude:".edy-bar-container"}),Edicy.on({"edicy:change:page_settings_url":this.handleSettingsLinkChange,"edicy:saving":this.handleSaveStarted,"edicy:openpicker":this.handleOpenPickerRequest},this),this.initPublishPopover(),this.$el.hasClass("edy-bar-initial-view")&&this.initIntro()},getDragProxy:function(t){return e("<div/>",{"class":"edy-thumb-actbtn-dragproxy"}).html(e(t).find(".edy-thumb-preview").html()).get(0)},getDragPayload:function(i){return t.compactObject({contentType:e(i).data("content-type"),contentOptions:e(i).data("content-options")})},handleThumbDragstart:function(t){e(t.originalEvent.detail.draggable).addClass("edy-thumb-actbtn-dragging")},handleThumbDragend:function(t){e(t.originalEvent.detail.draggable).removeClass("edy-thumb-actbtn-dragging")},handleThumbAppeared:function(){this.hidePicker()},showPicker:function(t,i){this.$(".edy-picker").addClass("edy-hidden"),t.removeClass("edy-hidden"),this.$("li.edy-active").removeClass("edy-active"),i.addClass("edy-active"),e(document.body).addClass("edy-bar-open").removeClass("edy-bar-closed"),Edicy.Animator.transition(this.$el,{addClass:"edy-picker-visible",end:this.correctPickerHeightClass.bind(this)})},hidePicker:function(){this.$(".edy-active").removeClass("edy-active"),Edicy.Animator.transition(this.$el,{removeClass:"edy-picker-visible",end:t.bind(function(){this.$(".edy-picker").addClass("edy-hidden")},this)}),e(document.body).removeClass("edy-bar-open").addClass("edy-bar-closed")},togglePicker:function(e,t){e.hasClass("edy-hidden")?this.showPicker(e,t):this.hidePicker()},correctPickerHeightClass:function(){this.$(".edy-picker:not(.edy-hidden)").each(function(t,i){var s=e(i);i.clientHeight<s.height()?s.addClass("edy-picker-compact"):s.hasClass("edy-picker-compact")&&s.removeClass("edy-picker-compact")})},handleOpenPickerRequest:function(e){"content"==e?this.showPicker(this.$("#edy-picker-content"),this.$("#edy-mm-content").closest("li")):"files"==e&&this.$("#edy-mm-files").trigger("click")},handleContentLinkClick:function(t){t.preventDefault(),this.togglePicker(this.$("#edy-picker-content"),e(t.target).closest("li"))},handleSettingsLinkChange:function(e){this.$(".edy-bar-tools-settings").attr("href",e)},handleSettingsLinkClick:function(t){if(t.preventDefault(),!this.siteMenuPopover){var i=e(t.target).closest("a");this.siteMenuPopover=new Edicy.SiteMenuPopoverView({parent:i.closest("li"),url:i.attr("href")}).render()}this.siteMenuPopover.toggle()},handleAccountLinkClick:function(t){if(t.preventDefault(),!this.accountMenuPopover){var i=e(t.target).closest("a");this.accountMenuPopover=new Edicy.SiteMenuPopoverView({parent:i.closest("li"),url:i.attr("href")}).render()}this.accountMenuPopover.toggle()},handleOpenfilesRequest:function(){this.$(".edy-mm-link-files").trigger("click")},handleUploadProgress:function(){var e=this.el.querySelector(".edy-mm-files .edy-mm-ico");e.querySelector("svg:not(.progress-circle)").setAttribute("class","edy-invisible"),Edicy.progressCircle(e,{progress:Edicy.assets.getUploadProgress(),bgStroke:5,fgStroke:5,width:30,height:30,bgColor:"rgba(0,0,0,0.25)",fgColor:"rgba(0,0,0,0.5)"}).setProgress(Edicy.assets.getUploadProgress())},handleUploadConfirmed:function(){if(Edicy.assets.hasAllUploaded()){var e=this.el.querySelector(".edy-mm-files .edy-mm-ico");Edicy.removeProgressCircle(e),e.querySelector("svg").removeAttribute("class")}},handleFilesClick:function(t){t.preventDefault(),this.togglePicker(this.$("#edy-picker-files"),e(t.target).closest("li"))},handleFilesLoadComplete:function(t){return e(t.target).closest("a").removeAttr("data-remote"),this.assetsView?(this.assetsView.el=this.$(".edy-picker-files"),void 0):(this.assetsView=new Edicy.AssetsView({el:this.$(".edy-picker-files"),collection:Edicy.assets}),this.correctPickerHeightClass(),void 0)},handleArticlesClick:function(t){t.preventDefault(),this.togglePicker(this.$("#edy-picker-articles"),e(t.target).closest("li"))},handleArticlesLoadComplete:function(t){e(t.target).closest("a").removeAttr("data-remote"),this.articlesView=new Edicy.ArticlesPanelView({el:this.$("#edy-picker-articles")}),this.correctPickerHeightClass()},handleReportsLinkClick:function(t){if(t.preventDefault(),!this.reportsPopover){var i=e(t.target).closest("a");this.reportsPopover=new Edicy.PopoverView({parent:i.closest("li"),url:i.attr("href"),orientation:"top",relative:!0,arrow:"big",containerClass:"edy-picker-popover"}).render(),this.reportsPopover.on("edicy:popover:closed",function(){this.$(".edy-mm-link-reports").closest("li").removeClass("edy-active")},this)}this.reportsPopover.toggle()},handleHelpLinkClick:function(t){if(t.preventDefault(),!this.helpPopover){var i=e(t.target).closest("a");this.helpPopover=new Edicy.HelpPopoverView({parent:i.closest(".edy-inner"),url:i.attr("href")}).render()}this.helpPopover.toggle()},triggerSave:function(){Edicy.trigger("edicy:save")},handleSaveStarted:function(t){this.queuedSaves||(this.queuedSaves=0);var i=this.queuedSaves,s=this.$(".edy-bar-tools-save"),n=document.getElementById("edy-svg-cloud-path");if(animation=document.getElementById("edy-svg-cloud-animation"),i+=1,s.addClass("edy-bar-saving"),""===animation.getAttribute("values")){var a=n.getAttribute("d"),o=n.getAttribute("data-alternate-path");animation.setAttribute("values",[a,o,a].join(";"))}animation.beginElement&&animation.beginElement(),e.when(t).always(function(){i>0&&(i-=1),0===i&&setTimeout(function(){s.removeClass("edy-bar-saving"),animation.endElement&&animation.endElement()},1500)})},handleKeydownEvent:function(e){e.altKey||!e.ctrlKey&&!e.metaKey||83==e.keyCode&&(e.preventDefault(),this.triggerSave())},handleKeyupEvent:function(e){27==e.keyCode&&this.$(".edy-picker:not(.edy-hidden)").length>0&&this.hidePicker()},handleSaveClick:function(){return this.triggerSave(),!1},initPublishPopover:function(){if(0!==this.$(".edy-publish-tpl").length){var e=this.$(".edy-bar-tools-settings");this.publishPopover=new Edicy.PopoverView({parent:e.closest(".edy-inner"),body:this.$(".edy-publish-tpl").html(),relative:!0,orientation:"top",arrow:"big"}).render(),this.publishPopover.on("edicy:popover:closed",function(){this.$(".edy-bar-tools-settings").removeClass("edy-mm-btn-notice")},this),this.$(".edy-publish-link").on("ajax:complete",t.bind(function(){this.publishPopover.hide()},this)),this.$(".edy-bar-tools-settings").addClass("edy-mm-btn-notice"),this.showPublishPopover();var i;this.$el.on("mouseenter",".edy-bar-settings-draft",t.bind(function(){i=setTimeout(t.bind(function(){this.showPublishPopover()},this),1e3)},this)).on("mouseleave",function(){clearTimeout(i)})}},showPublishPopover:function(){var e=setTimeout(t.bind(function(){this.publishPopover.hide()},this),5e3);this.publishPopover.show(),this.publishPopover.$el.one("mouseenter",function(){clearTimeout(e)}).one("mouseleave",t.bind(function(){e=setTimeout(t.bind(function(){this.publishPopover.hide()},this),3e3)},this))},initIntro:function(){setTimeout(t.bind(function(){this.$("#edy-mm-content").closest("li").addClass("edy-active")},this),1e3),setTimeout(t.bind(function(){this.showPicker(this.$("#edy-picker-content"),this.$("#edy-mm-content").closest("li"))},this),1500),setTimeout(t.bind(function(){this.introPopover=new Edicy.PopoverView({parent:this.$("#edy-mm-content"),body:this.$(".edy-intro-tpl").html(),orientation:"top",containerClass:"edy-intro-popover",relative:!0,sideClose:!0}).render(),this.introPopover.show()},this),2e3),setTimeout(t.bind(function(){Edicy.Animator.animate("edy-thumb-flash",this.$(".edy-picker-content .edy-content-thumb:first"))},this),2500),setTimeout(t.bind(function(){this.introPopover&&this.introPopover.hide()},this),8e3)},handleToggleDetailsClick:function(){var e,t=this.el.querySelector('[data-action-id="toolbar-main"]'),i=this.el.querySelector('[data-action-id="toolbar-details-container"]'),s=this.el.querySelector('[data-action-id="toolbar-details"]');window.requestAnimationFrame(function(){t.classList.contains("edy-bar-reveal-rightside")?(e=s.getBoundingClientRect(),t.classList.remove("edy-bar-reveal-rightside"),t.style[EdicyModernizr.prefixed("transform")]="translateX(0)"):(t.classList.add("edy-bar-reveal-rightside"),s.style.display="block",e=s.getBoundingClientRect(),t.style[EdicyModernizr.prefixed("transform")]="translateX(-"+e.width+"px)",i.style[EdicyModernizr.prefixed("transform")]="translateX("+e.width+"px)")})}})}(Edicy.jQuery,Edicy.Underscore),function(e,t){Edicy.ArticlesPanelView=Edicy.Backbone.View.extend({initialize:function(){this.$el.on("scroll",t.debounce(this.handleArticlesScroll.bind(this),500)),this.searchView=new Edicy.SearchInputView({el:this.$(".edy-search-form")})},handleArticlesScroll:function(){var t=this.$(".edy-thumbs");this.$el.scrollLeft()+this.$el.width()>t.width()-200&&t.attr("data-pagination-url")&&e.ajax({url:t.attr("data-pagination-url"),dataType:"script"})}})}(Edicy.jQuery,Edicy.Underscore),function(e){Edicy.SiteMenuPopoverView=Edicy.Backbone.View.extend({events:{"click .edy-site-switcher-current":"handleSiteSwitcherClick","ajax:beforeSend .edy-site-switcher-current":"handleSiteSwitcherLoad","ajax:complete .edy-site-switcher-current":"handleSiteSwitcherLoaded"},popoverOptions:{orientation:"top",containerClass:"edy-picker-popover",arrow:"big",relative:!0},initialize:function(){this.on("edicy:popover:closed",function(){this.$(".edy-site-switcher").hide(),this.$(".edy-account-links").show(),this.setPosition()},this)},handleSiteSwitcherLoad:function(){this.$(".edy-site-switcher-loader").dotLoader()},handleSiteSwitcherClick:function(e){e.preventDefault(),this.$(".edy-site-switcher").toggle(),this.$(".edy-account-links").toggle(),this.$(".edy-site-switcher").is(":visible")?this.$(".edy-site-switcher-header").addClass("edy-site-switcher-open"):this.$(".edy-site-switcher-header").removeClass("edy-site-switcher-open"),this.setPosition()},handleSiteSwitcherLoaded:function(t){e(t.target).removeAttr("data-remote"),this.setPosition()}}),Edicy.Backbone.mixin(Edicy.SiteMenuPopoverView,Edicy.PopoverViewMixin)}(Edicy.jQuery,Edicy.Underscore),function(){var e=function(){document.querySelector(".edy-content-trashcan").classList.add("edy-content-trashcan-visible")},t=function(){document.querySelector(".edy-content-trashcan").classList.remove("edy-content-trashcan-visible")},i=function(e){document.querySelector(".edy-content-trashcan").classList.add("edy-content-trashcan-dragover"),e.detail.helper.classList.add("edy-trashcan-helper-deleting"),e.detail.draggable.classList.add("edy-trashcan-draggable-deleting")},s=function(e){document.querySelector(".edy-content-trashcan").classList.remove("edy-content-trashcan-dragover"),e.detail.helper.classList.remove("edy-trashcan-helper-deleting"),e.detail.draggable.classList.remove("edy-trashcan-draggable-deleting")},n=function(e){e.detail.draggable.dispatchEvent(new CustomEvent("edicy:content:deleterequested",{bubbles:!0,detail:e.detail.draggable}))};document.addEventListener("DOMContentLoaded",function(){document.body.addEventListener("edicy:content:dragstart",e),document.body.addEventListener("edicy:content:dragend",t),Edicy.event.on(document.body,"draggable:dragenter",".edy-content-trashcan",i),Edicy.event.on(document.body,"draggable:drop",".edy-content-trashcan",n),Edicy.event.on(document.body,"draggable:dragleave",".edy-content-trashcan",s)})}(),function(e){Edicy.UndoView=Edicy.Backbone.View.extend({events:{'click [data-behavior="restore-object"]':"handleRestoreClick",'click [data-behavior="closes-flash"]':"handleRestoreClose"},initialize:function(){this.collection.on({add:this.handleUndoAdd,remove:this.handleUndoRemove},this),Edicy.on("undo:objectdestroyed",this.handleDestroy,this),Edicy.on("undo:objectrestored",this.handleRestore,this),Edicy.on("undo:restoreerror",this.handleRestoreError,this)},render:function(){e("body").prepend(this.el)},handleUndoAdd:function(e){this.$el.html(JST["admin/templates/undo"]({model:e,restored_model:null,collection_size:this.collection.size()})),this.render()},handleUndoRemove:function(e){model=this.collection.last(),this.$el.html(JST["admin/templates/undo"]({model:model,restored_model:e,collection_size:this.collection.size()})),this.render()},handleRestoreClick:function(t){e(t.target).dotLoader({replace:!0})},handleDestroy:function(t){e(".edy-flash").remove(),this.collection.add(new Edicy.Undo(t))},handleRestore:function(t){e(".edy-flash").remove(),this.collection.remove(new Edicy.Undo(t))},handleRestoreError:function(e){this.$el.html(JST["admin/templates/undo_error"]({message:e})),this.render()},handleRestoreClose:function(){e(".edy-restore-notice").remove()}})}(Edicy.jQuery),function(){Edicy.LanguageCreateView=Edicy.Backbone.View.extend({events:{"ajax:before":"handleCreateStarted"},render:function(){return this},handleCreateStarted:function(){this.$(".edy-btn").dotLoader({replace:!0})}})}(Edicy.jQuery),function(e){Edicy.LanguageEditView=Edicy.Backbone.View.extend({events:{"confirm:complete .edy-lang-remove":"handleDeleteLanguageClick",change:"handleInputChanged"},handleDeleteLanguageClick:function(t,i){return 1==i&&0==confirm(e(t.currentTarget).data("reconfirm"))?!1:void 0},handleInputChanged:function(t){e(t.target).closest("form").submit()}})}(Edicy.jQuery),function(e,t){Edicy.AssetLightboxView=Edicy.Backbone.View.extend({events:{"edicy:modal:keyup":"handleModalKeyup"},panelOptions:{closeBtn:!0},initialize:function(){t.bindAll(this,"handleImageLoaded","handleModalKeyup")},render:function(){return this.setBody(JST["admin/templates/lightbox"](this.options)),this.$image=this.$(".edy-lightbox-image"),this.$image.on("load",this.handleImageLoaded),this},showAsset:function(e){this.model=e,this.setSize(e.get("width"),e.get("height")),this.$image.attr("src")!=e.get("src")&&(this.showLoader(),this.$image.attr("src",e.get("src"))),this.show()},showPrevious:function(){var e=this.collection.previousAsset(this.model);e&&this.showAsset(e)},showNext:function(){var e=this.collection.nextAsset(this.model);e&&this.showAsset(e)},showLoader:function(){0===this.$(".edy-modal-loader").length&&this.$el.prepend(e("<div>",{"class":"edy-modal-loader"})),this.$body.hide(),t.delay(function(e){e.spinner()},0,this.$(".edy-modal-loader").show())},hideLoader:function(){this.$(".edy-modal-loader").hide().spinner(!1),this.$body.show()},setSize:function(t,i){var s=i/t,n=50;e(window).height()&&e(window).height()-n<i&&(i=e(window).height()-n,t=i/s),e(window).width()&&e(window).width()-n<t&&(t=e(window).width()-n,i=t*s),this.$body.css({height:i,width:t}),this.$image.attr({height:i,width:t})},handleImageLoaded:function(){this.hideLoader()},handleModalKeyup:function(e,t){37==t.keyCode&&this.showPrevious(),39==t.keyCode&&this.showNext()}}),Edicy.Backbone.mixin(Edicy.AssetLightboxView,Edicy.PanelViewMixin)}(Edicy.jQuery,Edicy.Underscore),function(e,t){Edicy.AssetsView=Edicy.Backbone.View.extend({events:{"change .edy-upload-fileselect":"handleFileSelectChange","assets:listchange":"handleAssetslistChange",'click [data-behavior="opens-asset-upload-dialog"]':"handleOpenAssetUploadClick",'click [data-behavior="delete-asset"]':"handleDeleteAssetClick",'click [data-behavior="preview-asset"]':"handlePreviewAssetClick",'click [data-behavior="select-asset"]':"handleSelectAssetClick",'click [data-behavior="select-all-assets"]':"handleSelectAllAssetsClick",'click [data-behavior="deselect-all-assets"]':"handleDeselectAllAssetsClick",'click [data-behavior="show-collections"]':"handleShowCollectionsClick",'click [data-behavior="remove-selected-assets"]':"handleRemoveSelectedAssetsClick",'confirm:complete [data-behavior="delete-selected-assets"]':"handleDeleteSelectedAssetsClick"},initialize:function(){t.bindAll(this,"handleScroll"),this.collection.on({add:this.handleAssetAdded,"change:thumbnail":this.handleThumbnailChange,"change:filename":this.handleFilenameChange,"change:dom_id":this.handleDomIdChange,"upload:progress":this.handleUploadProgress,"upload:confirmed":this.handleUploadConfirmed,"upload:failed":this.handleUploadFailed,"assets:change":this.handleAssetslistChange},this),this.lazyLoadImages(),e(window).on("resize",t.debounce(this.handleScroll,500)),this.isPicker()?(this.$el.on("scroll",t.debounce(this.handleScroll,500)),this.$el.on("scroll",function(){this.collectionsPopover&&this.collectionsPopover.isVisible()&&this.collectionsPopover.setPosition()}.bind(this))):e(window).on("scroll",t.debounce(this.handleScroll,500)),Edicy.dragdrop.draggables(this.el,".edy-asset-draggable",{handle:".edy-asset-preview",helper:this.getDragProxy,payload:this.getDragPayload,droppables:".edy-accepts-assets",exclude:".edy-bar-container",tolerance:"overlap"}),this.searchInputView=new Edicy.SearchInputView({el:this.$(".edy-search-form")})},isPicker:function(){return this.$el.is(".edy-picker")},handleAssetslistChange:function(){this.lazyLoadImages(),this.toggleSelectMode(),this.toggleEmptyState()},handleOpenAssetUploadClick:function(e){var t=this.el.querySelector('[data-action-id="asset-upload-fileselect"]');e.preventDefault(),t&&t.click()},getAssetTpl:function(e,t){return this.isPicker()?JST["admin/templates/asset_thumb"](t):JST["admin/templates/asset_row"](t)},handleAssetAdded:function(e){this.$(".edy-assets").prepend(this.getAssetTpl(e,{extension:e.getExtension(),filename:e.get("filename"),isImage:e.isImage(),cid:e.cid}));var t=this.getAssetPreview(e).get(0);t&&(this.isPicker()?Edicy.progressCircle(t,{progress:0,width:65,height:65,bgColor:"rgba(0,0,0,0.25)",fgColor:"rgba(0,0,0,0.5)",bgStroke:10,fgStroke:10}):Edicy.progressCircle(t,{progress:0,width:32,height:32,bgColor:"rgba(0,0,0,0.25)",fgColor:"rgba(0,0,0,0.5)",bgStroke:5,fgStroke:5}))},getAssetPreview:function(e){return this.$('.edy-asset[data-cid="'+e.cid+'"] .edy-asset-preview')},handleDomIdChange:function(e){this.$('.edy-asset[data-cid="'+e.cid+'"]').attr("id",e.get("dom_id"))},handleThumbnailChange:function(e){this.getAssetPreview(e).css("background-image","url("+e.get("thumbnail")+")")},handleFilenameChange:function(e){this.$('.edy-asset[data-cid="'+e.cid+'"] .edy-asset-name').html(e.get("filename"))},handleUploadProgress:function(e,t){var i=this.getAssetPreview(e).get(0);i&&Edicy.updateProgressCircle(i,t.progress)},handleUploadFailed:function(e,t,i){this.removePlaceholder(e.cid),this.isPicker()?this.blinkToolbarQuotaNotice():this.blinkFullViewQuotaNotice(),this.showNotice(JSON.parse(i.responseText))},blinkToolbarQuotaNotice:function(){Edicy.Animator.animate("pulsing",e(".edy-bar-container .toolbar-asset-quota-notice .edy-rounded-btn"))},blinkFullViewQuotaNotice:function(){Edicy.Animator.animate("pulsing",this.$(".edy-asset-quota-box"))},removePlaceholder:function(e){var t=3e3,i=500,s=this.$('[data-cid="'+e+'"]');s.css("opacity","0.5").find(".progress-circle").remove(),s.delay(t).fadeOut(i,function(){s.remove()})},showNotice:function(i){var s=6e3,n=500;e(".edy-header-flash").length||e("body").prepend('<div class="edy-flash edy-header-flash"></div>'),t.each(t.keys(i.errors),function(t){var a=e('<div class="edy-flash-alert">'+i.errors[t]+"</div>");e(".edy-header-flash").html(a),a.delay(s).fadeOut(n,function(){a.remove()})})},handleUploadConfirmed:function(){this.lazyLoadImages()},handleFileSelectChange:function(e){e.preventDefault(),this.collection.uploadFiles(e.target.files)},handleScroll:function(){this.isPicker()&&this.$el.scrollLeft()+this.$el.width()>this.$(".edy-thumbs").width()-200&&this.$(".edy-thumbs").attr("data-pagination-url")&&e.ajax({url:this.$(".edy-thumbs").attr("data-pagination-url"),dataType:"script"}),this.lazyLoadImages()},lazyLoadImages:function(){this.isPicker()?this.loadImagesInView(this.$(".edy-thumbs").scrollLeft(),e(window).width(),"left"):this.loadImagesInView(e(document).scrollTop(),e(window).height(),"top")},loadImagesInView:function(t,i,s){this.$(".edy-asset-lazyload").each(function(){var n=e(this),a="top"==s?n.offset().top:n.offset().left;n.data("thumbnail")&&a>t-100&&t+i>a&&(n.find(".edy-asset-preview").css("background-image",'url("'+Edicy.StringUtil.url_encode_quotes(n.data("thumbnail"))+'")'),n.removeClass("edy-asset-lazyload"))})},getDragProxy:function(t){return e("<div>",{"class":"edy-asset-dragproxy"}).css({"background-image":e(t).find(".edy-asset-preview").css("background-image")}).get(0)},getDragPayload:function(e){var i={id:parseInt(e.getAttribute("data-id"),10),type:e.classList.contains("edy-asset-image")?"photo":"file",url:e.getAttribute("data-url")};if(e.hasAttribute("data-thumbnail")&&(i.thumbnail=e.getAttribute("data-thumbnail")),e.hasAttribute("data-sizes")){var s=JSON.parse(e.getAttribute("data-sizes")),n=t.find(s,function(t){return+t.id===+e.getAttribute("data-id")});i.width=n.width,i.height=n.height,i.sizes=s}return i},handleDeleteAssetClick:function(e){var t=Edicy.dom.closest(e.target,".edy-asset"),i=t.querySelector('[data-action-id="delete-asset-btn"]');e.preventDefault(),e.stopPropagation(),confirm(i.getAttribute("data-confirm"))&&this.deleteAsset(t)},deleteAsset:function(t){var i=t.querySelector('[data-action-id="delete-asset-btn"]');t.classList.add("edy-deleting"),e.ajax({url:i.getAttribute("href"),method:"delete",dataType:"script",success:this.toggleSelectMode.bind(this)})},openPanelPreview:function(e){if(e.hasClass("edy-asset-image")){if(this.initLightBox(),this.lightboxView&&e.data("id")){var t=this.lightboxView.collection.get(e.data("id"));t&&this.lightboxView.showAsset(t)}}else e.hasClass("edy-asset-file")&&e.data("url")&&window.open(e.data("url"),"_blank")},choosePreviewSizeIndex:function(e){var t=window.innerWidth,i=e[0];return e.forEach(function(e){i.width>t&&e.width<t&&(i=e)}),i},initLightBox:function(){this.imagePreviewModels=t.map(this.$(".edy-asset-image"),function(t){var i,s,n,a=e(t).data("sizes");return a&&(i=this.choosePreviewSizeIndex(a),s=i.width,n=i.height),i&&new Edicy.Backbone.Model({id:t.getAttribute("data-id"),src:i.url,width:s,height:n})},this),this.imagePreviewCollection?this.imagePreviewCollection.reset(this.imagePreviewModels):this.imagePreviewCollection=new Edicy.GalleryAssetsCollection(this.imagePreviewModels,{comparator:function(e,t){return e.get("id")>t.get("id")?-1:1}}),this.lightboxView||(this.lightboxView=new Edicy.AssetLightboxView({collection:this.imagePreviewCollection}).render())},handlePreviewAssetClick:function(t){t.preventDefault(),t.stopPropagation();var i=e(t.target).closest(".edy-asset");i.data("id")&&this.openPanelPreview(i)},handleSelectAssetClick:function(e){e.preventDefault(),e.stopPropagation();var t=Edicy.dom.closest(e.target,".edy-asset");t&&(t.classList.toggle("edy-asset-selected"),this.toggleSelectMode())},handleSelectAllAssetsClick:function(e){e.preventDefault(),[].forEach.call(this.el.querySelectorAll(".edy-asset"),function(e){e.classList.add("edy-asset-selected")}),this.toggleSelectMode()},handleDeselectAllAssetsClick:function(e){e.preventDefault(),this.deselectAllAssets()},deselectAllAssets:function(){[].forEach.call(this.el.querySelectorAll(".edy-asset"),function(e){e.classList.remove("edy-asset-selected")}),this.toggleSelectMode()},toggleSelectMode:function(){var e=!!this.el.querySelector(".edy-asset-selected"),t=e?this.isCollectionSelected()?"collection-selected":"selected":"default";[].forEach.call(this.el.querySelectorAll(".edy-asset"),function(t){e?(t.classList.add("edy-asset-selectmode"),t.setAttribute("data-behavior","select-asset")):(t.classList.remove("edy-asset-selectmode"),t.removeAttribute("data-behavior"))}),[].forEach.call(this.el.querySelectorAll("[data-action-for]"),function(e){e.classList.add("edy-hidden")}),[].forEach.call(this.el.querySelectorAll('[data-action-for~="'+t+'"]'),function(e){e.classList.remove("edy-hidden")})},handleShowCollectionsClick:function(e){e.preventDefault();var t=Edicy.dom.closest(e.target,".edy-form-inline"),i=Edicy.dom.closest(e.target,"a");this.collectionsPopover?this.collectionsPopover.setParent(t):(this.collectionsPopover=new Edicy.MediasetPickerView({parent:t,orientation:this.isPicker()?"top":"bottom",relative:!1,url:i.getAttribute("href")}).render(),this.collectionsPopover.on({"mediaset:selected":this.handleMediasetSelected,"mediaset:unselected":this.handleMediasetUnselected,"mediaset:deleted":this.handleMediasetDeleted},this)),this.collectionsPopover.toggle()},handleRemoveSelectedAssetsClick:function(t){var i=Edicy.dom.closest(t.target,"a");t.preventDefault(),i&&e.ajax({url:i.getAttribute("href"),method:"delete",dataType:"script",data:{mediaset:{asset_ids:this.getSelectedAssetIds()}}})},handleMediasetSelected:function(t){var i=this.getSelectedAssetIds();i.length>0?(this.collectionsPopover.highlightMediaset(t.mediaset_id),e.ajax({url:t.assets_add_path,method:"put",dataType:"json",data:{mediaset:{asset_ids:i}},success:this.handleAssetsAddedToCollection.bind(this)})):(e.ajax({url:t.assets_path,dataType:"script"}),this.collectionsPopover.hide())},handleAssetsAddedToCollection:function(){this.deselectAllAssets(),this.collectionsPopover.hide()},handleMediasetUnselected:function(t){e.ajax({url:t.assets_path,dataType:"script"})},handleMediasetDeleted:function(t){this.getSelectedCollectionId()==t.mediaset_id&&e.ajax({url:t.assets_path,dataType:"script"})},handleDeleteSelectedAssetsClick:function(e,t){e.preventDefault(),t&&this.getSelectedAssets().forEach(this.deleteAsset.bind(this))},isCollectionSelected:function(){var e=this.el.querySelector('[data-action-id="assets-collection-name"]');return e?e.hasAttribute("data-mediaset-id"):!1},getSelectedCollectionId:function(){return this.el.querySelector('[data-action-id="assets-collection-name"]').getAttribute("data-mediaset-id")},getSelectedAssets:function(){return[].slice.call(this.el.querySelectorAll(".edy-asset-selected"))},getSelectedAssetIds:function(){return this.getSelectedAssets().map(function(e){return e.getAttribute("data-id")})},toggleEmptyState:function(){var e=this.isPicker()?this.$(".edy-assets").children():this.$(".assets-list tbody .asset"),t=this.isPicker()?this.$(".edy-picker-scrollable"):this.$(".assets-fullview"),i="edy-no-content";e.length?t.removeClass(i):t.addClass(i)}})}(Edicy.jQuery,Edicy.Underscore),function(){Edicy.MediasetPickerView=Edicy.Backbone.View.extend({popoverOptions:{containerClass:"edy-popover-mediasets"},events:{"ajax:complete form":"handleFormSubmitComplete",'click [data-behavior="select-mediaset"]':"handleMediasetSelect",'click [data-behavior="unselect-mediaset"]':"handleMediasetUnselect","mediasets:changed":"handleMediasetListChanged","mediaset:created":"handleMediasetCreated","mediaset:deleted":"handleMediasetDeleted"},highlightMediaset:function(e){var t=this.el.querySelector('.edy-mediaset-item[data-id="'+e+'"]');t&&Edicy.Animator.animate("edy-anim-highlight",t)},handleFormSubmitComplete:function(e){Array.prototype.slice.call(e.target.querySelectorAll('input[type="text"]')).forEach(function(e){e.value=""}),this.setPosition()},handleMediasetListChanged:function(){this.setPosition()},handleMediasetCreated:function(e){this.highlightMediaset(e.target.getAttribute("data-id"))},handleMediasetDeleted:function(e){this.trigger("mediaset:deleted",{mediaset_id:e.originalEvent.detail.mediaset_id,assets_path:e.originalEvent.detail.assets_path})},handleMediasetSelect:function(e){e.preventDefault(),e.stopPropagation(),this.trigger("mediaset:selected",{mediaset_id:e.target.getAttribute("data-id"),mediaset_title:e.target.textContent,assets_path:e.target.getAttribute("href"),assets_add_path:e.target.getAttribute("data-add-assets-path")})},handleMediasetUnselect:function(e){e.preventDefault(),e.stopPropagation(),this.trigger("mediaset:unselected",{assets_path:e.target.getAttribute("href")}),this.hide()}}),Edicy.Backbone.mixin(Edicy.MediasetPickerView,Edicy.PopoverViewMixin)}(),function(e,t){Edicy.AssetPickerView=Edicy.Backbone.View.extend({popoverOptions:{url:"/admin/assets",containerClass:"edy-assetpicker",propagateClicks:!1},events:{"click .edy-asset":"handleAssetClick"},initialize:function(e){this.options=e,this.on("edicy:popover:loaded",this.handleLoaded,this)},handleScroll:function(){this.$(".edy-assetpicker-scroll").scrollTop()>this.$(".edy-assetpicker-assets").height()-this.$(".edy-assetpicker-scroll").height()-100&&this.paginateAssets(),this.loadImagesInView()},handleLoaded:function(){this.loadImagesInView(),this.$(".edy-assetpicker-scroll").on("scroll",t.debounce(this.handleScroll.bind(this),250)),this.adjustHeight(),this.adjustScrollWidth(),this.setPosition()},paginateAssets:function(){this.$(".edy-assets").attr("data-pagination-url")&&e.ajax({url:this.$(".edy-assets").attr("data-pagination-url"),dataType:"script",viewVariant:"popover"})},loadImagesInView:function(){var t=this.$(".edy-assetpicker-scroll").scrollTop(),i=this.$(".edy-assetpicker-scroll").height();this.$(".edy-asset-lazyload").each(function(){var s=e(this),n=s.position().top;s.data("thumbnail")&&t+i>n&&(s.find(".edy-asset-preview").css("background-image",'url("'+Edicy.StringUtil.url_encode_quotes(s.data("thumbnail"))+'")'),s.removeClass("edy-asset-lazyload"))})},handleAssetClick:function(t){var i=e(t.target).closest(".edy-asset");this.trigger("asset:selected",{type:i.hasClass("edy-asset-image")?"photo":"file",id:i.data("id"),thumbnail:i.data("thumbnail"),url:i.data("url"),width:i.data("width"),height:i.data("height")}),this.hide()},adjustHeight:function(){var t=e(".edy-assetpicker").get(0).getBoundingClientRect().bottom-15+"px";this.$(".edy-assetpicker-scroll").get(0).style.maxHeight=t,this.$(".edy-assetpicker-scroll").get(0).style.height=this.$(".edy-assetpicker-scroll").height()+"px"},adjustScrollWidth:function(){var t=e(".edy-popover.edy-assetpicker").get(0),i=e(t).find(".edy-popover-content .edy-assetpicker-scroll").get(0);i.scrollHeight>i.clientHeight&&e(t).addClass("scrollable")
}}),Edicy.Backbone.mixin(Edicy.AssetPickerView,Edicy.PopoverViewMixin),Edicy.ImagePickerView=Edicy.AssetPickerView.extend({popoverOptions:{url:"/admin/assets?kind=images",containerClass:"edy-assetpicker",propagateClicks:!1},events:t.extend(Edicy.AssetPickerView.prototype.events,{"assets:listchange":"loadImagesInView"}),handleAssetClick:function(t){var i=e(t.target).closest(".edy-asset");this.trigger("asset:selected",{type:"photo",id:i.data("id"),thumbnail:i.data("thumbnail"),url:i.data("url"),width:i.data("sizes")[0].width,height:i.data("sizes")[0].height}),this.hide()}})}(Edicy.jQuery,Edicy.Underscore),function(e){"use strict";Edicy.PageSettingsView=Edicy.Backbone.View.extend({mixins:[Edicy.ImagePickerMixin],events:{"click a[data-alert]":"handleAlertClick",'input input[data-behavior="changeslug"]':"handleChangesSlugInput",'change input[name="page[slug]"]':"handleSlugChange",'click [data-behavior~="toggles-privacy-settings"]':"handleVisibilityLinkClick",'click [data-behavior~="page-privacy-set-public"]':"handleSetPagePublicClick",'click [data-behavior~="page-privacy-set-private"]':"handleSetPagePrivateClick",'click [data-behavior~="hides-page-privacy"]':"handleHidePagePrivacyClick",'click [data-behavior~="toggles-page-privacy-upgrade"]':"handleTogglePagePrivacyUpgradeModal",'click [data-behavior~="toggle-forms"]':"toggleForms",'click [data-behavior~="duplicates-page"]':"handleDuplicateClick",'change select[name="page[content_origin_id]"]':"setLayoutSelectVisibility"},focusTitle:function(){this.$('input[name="page[title]"]').focus()},handleVisibilityLinkClick:function(e){e.preventDefault();var t=this.el.querySelector(".edy-modal").getBoundingClientRect(),i=this.el.querySelector(".edy-page-privacy-container").getBoundingClientRect(),s=this.el.querySelector(".edy-page-privacy-menu");s.classList.toggle("edy-hidden"),s.style.top=i.top-t.top+i.height+"px",s.style.left=i.left-t.left+"px"},handleSetPagePublicClick:function(e){e.preventDefault(),this.el.querySelector('[data-action-id="page-privacy-private-container"]').classList.add("edy-hidden"),this.el.querySelector('[data-action-id="page-privacy-published-container"]').classList.remove("edy-hidden"),this.setPagePrivacy(!1)},handleSetPagePrivateClick:function(e){e.preventDefault(),this.el.querySelector('[data-action-id="page-privacy-published-container"]').classList.add("edy-hidden"),this.el.querySelector('[data-action-id="page-privacy-private-container"]').classList.remove("edy-hidden"),this.setPagePrivacy(!0)},setPagePrivacy:function(e){var t=this.$('[data-action-id="page-privacy-menu-link"]');t.text(t.data(e?"private-text":"public-text")),this.$("#page_privacy").val(e)},handleHidePagePrivacyClick:function(e){e.preventDefault();var t=this.el.querySelector(".edy-page-privacy-menu");t.classList.add("edy-hidden")},handleTogglePagePrivacyUpgradeModal:function(e){e.preventDefault();var t=this.el.querySelector(".edy-form-container"),i=this.el.querySelector(".edy-upgrade-container");this.el.classList.toggle("upgrade-modal"),t.classList.toggle("edy-hidden"),i.classList.toggle("edy-hidden")},handleChangesSlugInput:function(t){var i=e(t.target),s=this.$('input[name="page[slug]"]');s.val(getSlug(i.val(),{custom:Edicy.slugReplacements}))},handleSlugChange:function(){var e=this.$('.edy-new-page-form input[name="page[slug]"]');e.val(getSlug(e.val(),{custom:Edicy.slugReplacements}))},handleAlertClick:function(t){t.preventDefault(),alert(e(t.target).closest("[data-alert]").attr("data-alert"))},toggleForms:function(t){t.preventDefault(),e(".edy-new-page-form, .edy-new-link-form").toggleClass("edy-hidden")},handleDuplicateClick:function(t){e(t.target).dotLoader({replace:!0})},setLayoutSelectVisibility:function(){var e=this.$('select[name="page[layout_id]"]').closest(".edy-form-group"),t=this.$('select[name="page[content_origin_id]"]').val();e.toggleClass("edy-hidden",!!t)}})}(Edicy.jQuery),Edicy.dragdrop=Dragdrop.noConflict(),function(){Edicy.undoStack=new Edicy.Backbone.Collection,Edicy.undo_view=new Edicy.UndoView({collection:Edicy.undoStack})}(),Edicy.jQuery(function(e){e.fn.placeholder.input||e("input").placeholder({customClass:"edy-placeholder"}),e.fn.placeholder.textarea||e("textarea").placeholder({customClass:"edy-placeholder"})}),document.addEventListener("DOMContentLoaded",function(){document.addEventListener("click",function(e){for(var t,i=document.querySelectorAll("[data-sidecloses]"),s=0,n=i.length;n>s;s++)if(t=i[s],!t.contains(e.target)){if(t.hasAttribute("data-sideclose-id")&&Edicy.dom.closest(e.target,'[data-sideclose-pass="'+t.getAttribute("data-sideclose-id")+'"]'))continue;t.hasAttribute("data-sidecloses-with")?t.classList.add(t.getAttribute("data-sidecloses-with")):t.dispatchEvent(new CustomEvent("sideclose",{bubbles:!0,detail:{source:e.target}}))}})}),document.addEventListener("DOMContentLoaded",function(){Edicy.event.on(document.body,"change",".edy-select select",function(e){var t=e.target,i=Edicy.dom.closest(t,".edy-select").querySelector(".edy-select-text");i&&(i.innerHTML=t.options[t.selectedIndex].textContent)}),Edicy.event.on(document.body,"webkitmouseforcewillbegin","[data-remote],[data-method],[data-disable-forcetouch]",function(e){e.preventDefault(),e.stopPropagation()})});